<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <meta name="twitter:card" content=summary > <meta name="twitter:title" content="Juliaã®ä¸–ç•Œ |&gt; BDA3ã®2.11 Exercisesã®9ã‚’è§£ã"> <meta name="twitter:site" content="@dokudo91"> <meta name="twitter:description" content="BDA3ã®2.11 Exercisesã®9ã‚’è§£ãã€‚"> <meta name="twitter:image" content="https://dokudo91.github.io/assets/ã‚½ãƒ•ã‚£ãƒ¼ã®ä¸–ç•Œ.png"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%220%22 y=%2280%22 font-family=%22Arial%22 font-size=%2285%22>ğŸ˜€</text></svg>"> <title>BDA3ã®2.11 Exercisesã®9ã‚’è§£ã</title> <header> <div class=blog-name ><a href="/">Juliaã®ä¸–ç•Œ</a></div> </header> <div class=franklin-content ><p>BDA3ã®2.11 Exercisesã®9ã‚’è§£ãã€‚ ãƒªãƒ³ã‚¯ã¯<a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a>ã€‚</p> <h1 id=ol_start9_setting_parameters_for_a_beta_prior_distribution ><a href="#ol_start9_setting_parameters_for_a_beta_prior_distribution" class=header-anchor ><ol start=9 > <li><p>Setting parameters for a beta prior distribution</p> </ol> </a></h1> <p>Î¸ã®äº‹å‰åˆ†å¸ƒã¯Beta&#40;Î±,Î²&#41;åˆ†å¸ƒã«å¾“ã†ã¨ã™ã‚‹ã€‚ãã®å¹³å‡ã¯0.6ã§ã‚ã‚Šã€æ¨™æº–åå·®ã¯0.3ã§ã‚ã‚‹ã€‚</p> <h2 id="a_betaÎ±Î²"><a href="#a_betaÎ±Î²" class=header-anchor >&#40;a&#41; Beta&#40;Î±,Î²&#41;</a></h2> <p>Î±ã¨Î²ã®å€¤ã¯ä½•ã«ãªã‚‹ã‹ï¼Ÿ</p> <p>æœ¬æ–‡&#40;A.3&#41;ã‚ˆã‚Šã€</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>Î±</mi><mo>+</mo><mi>Î²</mi><mo>=</mo><mfrac><mrow><mi>E</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mo stretchy=false >(</mo><mn>1</mn><mo>âˆ’</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo stretchy=false >)</mo></mrow></mfrac><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex"> Î±+Î²=\frac{E(Î¸)(1-E(Î¸))}{var(Î¸)}-1 </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >))</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span></span> <p>ä»Šã€<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mo>=</mo><mn>0.6</mn><mo separator=true >,</mo><mi>v</mi><mi>a</mi><mi>r</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mo>=</mo><mn>0.</mn><msup><mn>3</mn><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E(Î¸)=0.6,var(Î¸)=0.3^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >0.6</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord >0.</span><span class=mord ><span class=mord >3</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>ã‚ˆã‚Šã€</p> <pre><code class="julia hljs">aplusb=rationalize(<span class=hljs-number >0.6</span>*(<span class=hljs-number >1</span>-<span class=hljs-number >0.6</span>))//rationalize(<span class=hljs-number >0.3</span>)^<span class=hljs-number >2</span>-<span class=hljs-number >1</span></code></pre><pre><code class="plaintext hljs">5//3</code></pre>
<p>Î±&#43;Î²&#61;5/3ã§ã‚ã‚‹ã€‚ ã¾ãŸã€å¼•ãç¶šãæœ¬æ–‡&#40;A.3&#41;ã‚ˆã‚Šã€</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>Î±</mi><mo>=</mo><mo stretchy=false >(</mo><mi>Î±</mi><mo>+</mo><mi>Î²</mi><mo stretchy=false >)</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mo separator=true >,</mo><mspace linebreak=newline ></mspace><mi>Î²</mi><mo>=</mo><mo stretchy=false >(</mo><mi>Î±</mi><mo>+</mo><mi>Î²</mi><mo stretchy=false >)</mo><mo stretchy=false >(</mo><mn>1</mn><mo>âˆ’</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">
Î±=(Î±+Î²)E(Î¸), \\
Î²=(Î±+Î²)(1-E(Î¸))
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mpunct >,</span></span><span class="mspace newline"></span><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose >)</span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >))</span></span></span></span></span>
<pre><code class="julia hljs">Î±=aplusb*<span class=hljs-number >0.6</span>
Î²=aplusb*(<span class=hljs-number >1</span>-<span class=hljs-number >0.6</span>)|&gt;rationalize
(Î±,Î²)</code></pre><pre><code class="plaintext hljs">(1.0, 2//3)</code></pre>
<p>å¾“ã£ã¦ã€Î±&#61;1ã€Î²&#61;2/3ã§ã‚ã‚‹ã€‚</p>
<h3 id=sketch ><a href="#sketch" class=header-anchor >Sketch</a></h3>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, StatsPlots
prior_dist=Beta(Î±,Î²)
plot(prior_dist,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;Beta(Î±=1,Î²=2/3)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;prior.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre>
<img src="/assets/pages/BDA3_Exercises2_11_9/code/output/prior.svg" alt="">
<h2 id="b_ã‚«ãƒ«ãƒ•ã‚©ãƒ«ãƒ‹ã‚¢ã®æ­»åˆ‘æ”¯æŒè€…"><a href="#b_ã‚«ãƒ«ãƒ•ã‚©ãƒ«ãƒ‹ã‚¢ã®æ­»åˆ‘æ”¯æŒè€…" class=header-anchor >&#40;b&#41; ã‚«ãƒ«ãƒ•ã‚©ãƒ«ãƒ‹ã‚¢ã®æ­»åˆ‘æ”¯æŒè€…</a></h2>
<p>Î¸ã¯ã‚«ãƒ«ãƒ•ã‚©ãƒ«ãƒ‹ã‚¢ã®æ­»åˆ‘æ”¯æŒç‡ã§ã‚ã‚‹ã€‚Î¸ã®äº‹å‰åˆ†å¸ƒã¯Beta&#40;1,2/3&#41;ã«å¾“ã†ã¨ã™ã‚‹ã€‚ 1000äººã®ã‚«ãƒ«ãƒ•ã‚©ãƒ«ãƒ‹ã‚¢ä½äººã«ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ãŸã¨ã“ã‚ã€æ­»åˆ‘æ”¯æŒç‡ã¯65&#37;ã ã£ãŸã€‚ Î¸ã®äº‹å¾Œåˆ†å¸ƒã¯ã©ã†ãªã‚‹ã‹ï¼Ÿ</p>
<pre><code class="julia hljs">n=<span class=hljs-number >1000</span>
y=<span class=hljs-number >1000</span>*<span class=hljs-number >0.65</span>
posterior_dist=Beta(Î±+y,Î²+n-y)
plot(prior_dist,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;prior&quot;</span>)
plot!(posterior_dist,label=<span class=hljs-string >&quot;posterior&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre>
<img src="/assets/pages/BDA3_Exercises2_11_9/code/output/posterior.svg" alt="">
<pre><code class="julia hljs">(mean(posterior_dist),std(posterior_dist))</code></pre><pre><code class="plaintext hljs">(0.6499168053244593, 0.015063858467520737)</code></pre>
<p>E&#40;Î¸|y&#41;&#61;0.65ã€Ïƒ&#40;Î¸|y&#41;&#61;0.015ã§ã‚ã‚‹ã€‚</p>
<h2 id="c_äº‹å‰åˆ†å¸ƒã®å½±éŸ¿"><a href="#c_äº‹å‰åˆ†å¸ƒã®å½±éŸ¿" class=header-anchor >&#40;c&#41; äº‹å‰åˆ†å¸ƒã®å½±éŸ¿</a></h2>
<p>äº‹å‰åˆ†å¸ƒã‚’å¤‰ãˆã¦ã€äº‹å¾Œåˆ†å¸ƒãŒã©ã®ç¨‹åº¦å½±éŸ¿ã•ã‚Œã‚‹ã‹ç¢ºèªã™ã‚‹ã€‚</p>
<pre><code class="julia hljs">plot(posterior_dist,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;Beta(1+y,2/3+n-y)&quot;</span>,xlim=(<span class=hljs-number >0.5</span>,<span class=hljs-number >0.8</span>))
plot!(Beta(<span class=hljs-number >1</span>+y,<span class=hljs-number >10</span>+n-y),label=<span class=hljs-string >&quot;Beta(1+y,10+n-y)&quot;</span>)
plot!(Beta(y,n-y),label=<span class=hljs-string >&quot;Beta(y,n-y)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;sensitivity.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre>
<img src="/assets/pages/BDA3_Exercises2_11_9/code/output/sensitivity.svg" alt="">
<p>å›³ã‹ã‚‰äº‹å‰åˆ†å¸ƒã‚’æ¥µç«¯ã«å¤‰ãˆãªã„é™ã‚Šã¯äº‹å¾Œåˆ†å¸ƒã¯å¤§ããå¤‰ã‚ã‚‰ãªã„ã“ã¨ãŒã‚ã‹ã‚‹ã€‚ ã“ã‚Œã¯n&#61;1000ãŒååˆ†ã«å¤§ãã„ãŸã‚ã§ã‚ã‚‹ã€‚</p>
<div class=page-foot >
  <div class=copyright >
    &copy; dokudo91. Last modified: October 15, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>