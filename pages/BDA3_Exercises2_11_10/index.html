<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <meta name="twitter:card" content=summary > <meta name="twitter:title" content="Juliaの世界 |&gt; BDA3の2.11 Exercisesの10を解く"> <meta name="twitter:site" content="@dokudo91"> <meta name="twitter:description" content="BDA3の2.11 Exercisesの10を解く。"> <meta name="twitter:image" content="https://dokudo91.github.io/assets/ソフィーの世界.png"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%220%22 y=%2280%22 font-family=%22Arial%22 font-size=%2285%22>😀</text></svg>"> <title>BDA3の2.11 Exercisesの10を解く</title> <header> <div class=blog-name ><a href="/">Juliaの世界</a></div> </header> <div class=franklin-content ><p>BDA3の2.11 Exercisesの10を解く。 リンクは<a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a>。</p> <h1 id=ol_start10_discrete_sample_spaces ><a href="#ol_start10_discrete_sample_spaces" class=header-anchor ><ol start=10 > <li><p>Discrete sample spaces</p> </ol> </a></h1> <p>N個のケーブルカーがある。ケーブルカーは連番は付けられており、たまたま見たケーブルカーが203番だった。 この状況でNを推定したい。</p> <h2 id="a_幾何分布をnの事前分布にする"><a href="#a_幾何分布をnの事前分布にする" class=header-anchor >&#40;a&#41; 幾何分布をNの事前分布にする</a></h2> <p>Nの事前分布が幾何分布に従うとする。また、E&#40;N&#41;&#61;100とする。 幾何分布のPMFは</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>P</mi><mi>r</mi><mo stretchy=false >(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy=false >)</mo><mo>=</mo><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><mi>p</mi><msup><mo stretchy=false >)</mo><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>p</mi></mrow><annotation encoding="application/x-tex"> Pr(X=k)=(1-p)^{k-1}p </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">p</span></span></span></span></span> <p>である。意味としては当たり確率pのくじをk回目で当たりを引く確率である。</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>E</mi><mo stretchy=false >(</mo><mi>X</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mn>1</mn><mi>p</mi></mfrac></mrow><annotation encoding="application/x-tex"> E(X)=\frac{1}{p} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">p</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>であるので、<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mfrac><mn>1</mn><mn>100</mn></mfrac></mrow><annotation encoding="application/x-tex">p=\frac{1}{100}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.190108em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">100</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>である。結局、事前分布のPMFは</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>N</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mn>1</mn><mn>100</mn></mfrac><mo stretchy=false >(</mo><mfrac><mn>99</mn><mn>100</mn></mfrac><msup><mo stretchy=false >)</mo><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex"> p(N)=\frac{1}{100}(\frac{99}{100})^{N-1} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >100</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mopen >(</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >100</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >99</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.891331em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> <p>と表される。事後分布は</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>N</mi><mi mathvariant=normal >∣</mi><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >∣</mi><mi>N</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>N</mi><mo stretchy=false >)</mo></mrow><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo stretchy=false >)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex"> p(N|y)=\frac{p(y|N)p(N)}{p(y)} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>で計算できる。yは特定の番号を見るイベントである。 尤度関数p&#40;y|N&#41;はN&lt;yの時は最大数より大きい番号を見ることはないので</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >∣</mi><mi>N</mi><mo stretchy=false >)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex"> p(y|N)=0 </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></span> <p>y≤Nの時は等確率なので</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >∣</mi><mi>N</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac></mrow><annotation encoding="application/x-tex"> p(y|N)=\frac{1}{N} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>である。周辺分布p&#40;y&#41;は</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>N</mi><mo>=</mo><mn>1</mn></mrow><mi mathvariant=normal >∞</mi></munderover><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >∣</mi><mi>N</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>N</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(y)=\sum^{\infty}_{N=1}p(y|N)p(N) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.945733em;vertical-align:-1.294336em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6513970000000002em;"><span style="top:-1.855664em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∞</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.294336em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mclose >)</span></span></span></span></span> <p>であるが、これは∞が含まれるため計算が難しい。</p> <h3 id="juliaで確認"><a href="#juliaで確認" class=header-anchor >Juliaで確認</a></h3> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, StatsPlots
gprior_dist=Geometric(<span class=hljs-number >1</span>/<span class=hljs-number >100</span>)
plot(gprior_dist,label=<span class=hljs-string >&quot;prior&quot;</span>,yrotation=<span class=hljs-number >90</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;gprior.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises2_11_10/code/output/gprior.svg" alt=""> <p>事前分布はNが大きくなるに従い可能性が低くなる。</p> <pre><code class="julia hljs">likelihood(y,N)=ifelse(N&lt;y,<span class=hljs-number >0</span>,<span class=hljs-number >1</span>/N)
plot(<span class=hljs-number >1</span>:<span class=hljs-number >1000</span>,N-&gt;likelihood(<span class=hljs-number >203</span>,N),label=<span class=hljs-string >&quot;likelihood&quot;</span>,yrotation=<span class=hljs-number >90</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;likelihood.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises2_11_10/code/output/likelihood.svg" alt=""> <p>尤度関数は203までは0でその点で最大値を取り、徐々に0になる。</p> <pre><code class="julia hljs">marginal(y,summax,prior)=sum(prior(N)*likelihood(y,N) <span class=hljs-keyword >for</span> N <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:summax)
plot(<span class=hljs-number >1</span>:<span class=hljs-number >2000</span>,summax-&gt;marginal(<span class=hljs-number >203</span>,summax,x-&gt;pdf(gprior_dist,x)),label=<span class=hljs-string >&quot;marginal&quot;</span>,yrotation=<span class=hljs-number >90</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;marginal.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises2_11_10/code/output/marginal.svg" alt=""> <p>周辺分布はNを∞まで足す必要がある。プログラム的には計算不可能なので、summaxを増やして収束の様子を確認した。 summaxは1000あれば十分と判断する。</p> <pre><code class="julia hljs">posterior(N,y,prior)=prior(N)*likelihood(y,N)/marginal(y,<span class=hljs-number >1000</span>,prior)
plot(<span class=hljs-number >1</span>:<span class=hljs-number >1000</span>,N-&gt;posterior(N,<span class=hljs-number >203</span>,x-&gt;pdf(gprior_dist,x)),label=<span class=hljs-string >&quot;posterior&quot;</span>,yrotation=<span class=hljs-number >90</span>)
plot!(<span class=hljs-number >1</span>:<span class=hljs-number >1000</span>,N-&gt;likelihood(<span class=hljs-number >203</span>,N),label=<span class=hljs-string >&quot;likelihood&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises2_11_10/code/output/posterior.svg" alt=""> <p>事後分布は203まで0でその点で最大値を取り、その後0になる。 尤度関数と比較すると急速に0になるが、これは事前分布の影響が大きい。</p> <h2 id="b_事後分布の平均と標準偏差"><a href="#b_事後分布の平均と標準偏差" class=header-anchor >&#40;b&#41; 事後分布の平均と標準偏差</a></h2> <pre><code class="julia hljs">m=sum(posterior(N,<span class=hljs-number >203</span>,x-&gt;pdf(gprior_dist,x))*N <span class=hljs-keyword >for</span> N <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >1000</span>)</code></pre><pre><code class="plaintext hljs">279.020196507379</code></pre>
<p>平均は279個である。</p>
<pre><code class="julia hljs">sum((m-N)^<span class=hljs-number >2</span>*posterior(N,<span class=hljs-number >203</span>,x-&gt;pdf(gprior_dist,x)) <span class=hljs-keyword >for</span> N <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >1000</span>)|&gt;sqrt</code></pre><pre><code class="plaintext hljs">79.61534440524113</code></pre>
<p>標準偏差は79.6である。</p>
<h2 id="c_事前分布の妥当性"><a href="#c_事前分布の妥当性" class=header-anchor >&#40;c&#41; 事前分布の妥当性</a></h2>
<p>この問題で事前分布としてGeometic&#40;1/100&#41;はあまり妥当ではない。 N&#61;1が最も可能性が高いと考えているし、その平均も100である。 y&#61;203である時点で事前分布としては微妙である。</p>
<p>では、どのような事前分布がいいかというと難しい。 事前分布に強い信念がない時、無情報事前分布が妥当な選択肢である可能性がある。 例えばp&#40;N&#41;&#61;1/1000はどうだろうか？これは全範囲で積分すると無限大となるので確率分布としては不適である。 だが、無情報事前分布は確率分布として不適であっても、事後分布が解析可能であれば、採用可能である。 ここではp&#40;N&#41;&#61;1/1000*1/Nを採用する。 これはまだ確率分布としては不適であるが、1/Nが周辺分布の無限和の計算で有利に働く。</p>
<pre><code class="julia hljs">noninfo_prior(N)=<span class=hljs-number >1</span>/<span class=hljs-number >1000</span>/N
plot(<span class=hljs-number >1</span>:<span class=hljs-number >1000</span>,N-&gt;posterior(N,<span class=hljs-number >203</span>,noninfo_prior),label=<span class=hljs-string >&quot;noninfo_posterior&quot;</span>,yrotation=<span class=hljs-number >90</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;noninfo_posterior.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre>
<img src="/assets/pages/BDA3_Exercises2_11_10/code/output/noninfo_posterior.svg" alt="">
<p>幾何分布を用いた場合と比べて、0に近づく速度が緩やかになって、尤度関数に近い形になっている。</p>
<pre><code class="julia hljs">noninfo_m=sum(posterior(N,<span class=hljs-number >203</span>,noninfo_prior)*N <span class=hljs-keyword >for</span> N <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >1000</span>)</code></pre><pre><code class="plaintext hljs">405.5879830359966</code></pre>
<p>平均は406個である。</p>
<pre><code class="julia hljs">sum((noninfo_m-N)^<span class=hljs-number >2</span>*posterior(N,<span class=hljs-number >203</span>,noninfo_prior) <span class=hljs-keyword >for</span> N <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >1000</span>)|&gt;sqrt</code></pre><pre><code class="plaintext hljs">195.19259704706036</code></pre>
<p>標準偏差は195.2である。</p>
<p>幾何分布を用いた場合と比べて、平均は大きく、分散も大きくなっている。 そして、たった1つのケーブルカーの番号を見て全体の数を予測しようとしていることを考えると、 無情報事前分布を用いた結果の方が妥当である。</p>
<div class=page-foot >
  <div class=copyright >
    &copy; dokudo91. Last modified: October 02, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>