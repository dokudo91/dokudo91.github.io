<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <meta name="twitter:card" content=summary > <meta name="twitter:title" content="Juliaã®ä¸–ç•Œ |&gt; BDA3ã®2.11 Exercisesã®1ã‚’è§£ã"> <meta name="twitter:site" content="@dokudo91"> <meta name="twitter:description" content="BDA3ã®2.11 Exercisesã®1ã‚’è§£ãã€‚"> <meta name="twitter:image" content="https://dokudo91.github.io/assets/ã‚½ãƒ•ã‚£ãƒ¼ã®ä¸–ç•Œ.png"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%220%22 y=%2280%22 font-family=%22Arial%22 font-size=%2285%22>ğŸ˜€</text></svg>"> <title>BDA3ã®2.11 Exercisesã®1ã‚’è§£ã</title> <header> <div class=blog-name ><a href="/">Juliaã®ä¸–ç•Œ</a></div> </header> <div class=franklin-content ><p>BDA3ã®2.11 Exercisesã®1ã‚’è§£ãã€‚ ãƒªãƒ³ã‚¯ã¯<a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a>ã€‚</p> <h1 id=posterior_inference ><a href="#posterior_inference" class=header-anchor ><ol> <li><p>Posterior inference</p> </ol> </a></h1> <p>ã‚³ã‚¤ãƒ³ã‚’10å›æŒ¯ã‚‹ã€‚è¡¨ãŒå‡ºãŸå›æ•°ã¯3å›æœªæº€ã ã£ãŸã€‚è¡¨ãŒå‡ºã‚‹ç¢ºç‡Î¸ã®äº‹å‰åˆ†å¸ƒã¯Beta&#40;4,4&#41;ã ã¨è€ƒãˆã¦ã„ã‚‹ã€‚ ã‚³ã‚¤ãƒ³ã‚’10å›æŒ¯ã£ã¦è¡¨ãŒ3å›æœªæº€ã ã£ãŸã¨ã„ã†çµæœã‚’çŸ¥ã£ãŸå¾Œã®è¡¨ãŒå‡ºã‚‹ç¢ºç‡Î¸ã«å¯¾ã™ã‚‹äº‹å¾Œåˆ†å¸ƒã¯ã©ã†ãªã‚‹ã‹ï¼Ÿ</p> <h2 id="äº‹å‰åˆ†å¸ƒ"><a href="#äº‹å‰åˆ†å¸ƒ" class=header-anchor >äº‹å‰åˆ†å¸ƒ</a></h2> <p>Beta&#40;4,4&#41;ã®PDFã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>P</mi><mi>r</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo separator=true >;</mo><mi>Î±</mi><mo separator=true >,</mo><mi>Î²</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><msup><mi>Î¸</mi><mrow><mi>Î±</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy=false >(</mo><mn>1</mn><mo>âˆ’</mo><mi>Î¸</mi><msup><mo stretchy=false >)</mo><mrow><mi>Î²</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><mrow><mi>B</mi><mo stretchy=false >(</mo><mi>Î±</mi><mo>âˆ’</mo><mi>Î²</mi><mo stretchy=false >)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex"> Pr(Î¸;Î±,Î²)=\frac{Î¸^{Î±-1}(1-Î¸)^{Î²-1}}{B(Î±-Î²)} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mpunct >;</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.4621079999999997em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.5261079999999998em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">Î±</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">Î²</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>ã§ã‚ã‚‹ã€‚äºŒé …åˆ†å¸ƒã®PMFã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>P</mi><mi>r</mi><mo stretchy=false >(</mo><mi>k</mi><mo separator=true >;</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mo>=</mo><mrow><mo fence=true >(</mo><mfrac linethickness=0px ><mi>n</mi><mi>k</mi></mfrac><mo fence=true >)</mo></mrow><msup><mi>Î¸</mi><mi>k</mi></msup><mo stretchy=false >(</mo><mn>1</mn><mo>âˆ’</mo><mi>Î¸</mi><msup><mo stretchy=false >)</mo><mrow><mi>n</mi><mo>âˆ’</mo><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex"> Pr(k;Î¸)=\binom{n}{k}Î¸^k(1-Î¸)^{n-k} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mpunct >;</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mord ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">n</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span></span></span></span></span></span> <p>ã§ã‚ã‚‹ã€‚ã“ã®2ã¤ã®å¯¾æ¯”ã‹ã‚‰Betaåˆ†å¸ƒã®Î±ã¨Î²ã¯è¡¨ãŒå‡ºã‚‹å›æ•°ã«å¯¾ã™ã‚‹äº‹å‰ä¿¡å¿µã¨è§£é‡ˆã§ãã‚‹ã€‚ Î±ã¨Î²ãŒåŒã˜å€¤ã§ã‚ã‚Œã°ã€è¡¨ãŒå‡ºã‚‹ç¢ºç‡ã¯50&#37;ã§ã‚ã‚‹ã¨è€ƒãˆã¦ã„ã‚‹ã€‚Betaåˆ†å¸ƒã®å¹³å‡ã¨åˆ†æ•£ã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>Î¼</mi><mo>=</mo><mfrac><mi>Î±</mi><mrow><mi>Î±</mi><mo>+</mo><mi>Î²</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> Î¼=\frac{Î±}{Î±+Î²} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Î¼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.9880000000000002em;vertical-align:-0.8804400000000001em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.10756em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo>=</mo><mfrac><mrow><mi>Î±</mi><mi>Î²</mi></mrow><mrow><mo stretchy=false >(</mo><mi>Î±</mi><mo>+</mo><mi>Î²</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo stretchy=false >(</mo><mi>Î±</mi><mo>+</mo><mi>Î²</mi><mo>+</mo><mn>1</mn><mo stretchy=false >)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex"> Ïƒ^2=\frac{Î±Î²}{(Î±+Î²)^2(Î±+Î²+1)} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8641079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.3074399999999997em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>ã¨è¨ˆç®—ã•ã‚Œã‚‹ã€‚Î±ã¨Î²ã®å€¤ãŒå¤§ãããªã‚Œã°åˆ†æ•£ã¯å°ã•ããªã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions
<span class=hljs-keyword >using</span> StatsPlots

prior_dist=Beta(<span class=hljs-number >4</span>,<span class=hljs-number >4</span>)
plot(prior_dist,label=<span class=hljs-string >&quot;Beta(4,4)&quot;</span>,yrotation=<span class=hljs-number >90</span>)
plot!(Beta(<span class=hljs-number >5</span>,<span class=hljs-number >5</span>),label=<span class=hljs-string >&quot;Beta(5,5)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;prior_dist.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises2_11_1/code/output/prior_dist.svg" alt=""> <h2 id="å°¤åº¦é–¢æ•°"><a href="#å°¤åº¦é–¢æ•°" class=header-anchor >å°¤åº¦é–¢æ•°</a></h2> <p>è¡¨ãŒå‡ºã‚‹ç¢ºç‡Î¸ãŒäº‹å‰åˆ†å¸ƒBeta&#40;4,4&#41;ã«å¾“ã†æ™‚ã€ã‚³ã‚¤ãƒ³ã‚’10å›æŒ¯ã£ã¦è¡¨ãŒyå›å‡ºã‚‹ç¢ºç‡ã¯å°¤åº¦é–¢æ•°<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >âˆ£</mi><mi>Î¸</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">p(y|Î¸)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >âˆ£</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span></span></span></span>ã§è¡¨ã•ã‚Œã‚‹ã€‚</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >âˆ£</mi><mi>Î¸</mi><mo stretchy=false >)</mo><mo>=</mo><mtext>Binomial</mtext><mo stretchy=false >(</mo><mi>n</mi><mo>=</mo><mn>10</mn><mo separator=true >,</mo><mi>p</mi><mo>=</mo><mi>Î¸</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(y|Î¸)=\text{Binomial}(n=10,p=Î¸) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >âˆ£</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class=mord >Binomial</span></span><span class=mopen >(</span><span class="mord mathnormal">n</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class=mord >10</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span></span></span></span></span> <p>å°¤åº¦é–¢æ•°ã¯äºŒé …åˆ†å¸ƒã«å¾“ã†ã€‚</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >âˆ£</mi><mi>Î¸</mi><mo stretchy=false >)</mo><mo>=</mo><mrow><mo fence=true >(</mo><mfrac linethickness=0px ><mi>n</mi><mi>y</mi></mfrac><mo fence=true >)</mo></mrow><msup><mi>Î¸</mi><mi>y</mi></msup><mo stretchy=false >(</mo><mn>1</mn><mo>âˆ’</mo><mi>Î¸</mi><msup><mo stretchy=false >)</mo><mrow><mi>n</mi><mo>âˆ’</mo><mi>y</mi></mrow></msup></mrow><annotation encoding="application/x-tex"> p(y|Î¸)=\binom{n}{y}Î¸^y(1-Î¸)^{n-y} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >âˆ£</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class=mord ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.10756em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">n</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.714392em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.071331em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.821331em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span></span></span></span></span></span></span></span></span> <p>è¡¨ãŒå‡ºã‚‹å›æ•°ãŒ3å›æœªæº€ã¨ãªã‚‹ç¢ºç‡ã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo>&lt;</mo><mn>3</mn><mi mathvariant=normal >âˆ£</mi><mi>Î¸</mi><mo stretchy=false >)</mo><mo>=</mo><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo>=</mo><mn>0</mn><mi mathvariant=normal >âˆ£</mi><mi>Î¸</mi><mo stretchy=false >)</mo><mo>+</mo><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant=normal >âˆ£</mi><mi>Î¸</mi><mo stretchy=false >)</mo><mo>+</mo><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo>=</mo><mn>2</mn><mi mathvariant=normal >âˆ£</mi><mi>Î¸</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(y&lt;3|Î¸)=p(y=0|Î¸)+p(y=1|Î¸)+p(y=2|Î¸) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >3âˆ£</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >0âˆ£</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1âˆ£</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >2âˆ£</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span></span></span></span></span> <p>ã¨è¨ˆç®—ã§ãã‚‹ã€‚</p> <pre><code class="julia hljs">likelihood_dist(Î¸)=Binomial(<span class=hljs-number >10</span>,Î¸)
likelihood_function(y,Î¸)=pdf(likelihood_dist(Î¸),y)
likelihood_function(Î¸)=likelihood_function.(<span class=hljs-number >0</span>:<span class=hljs-number >2</span>,Î¸)|&gt;sum
likelihood_function.([<span class=hljs-number >0.1</span>,<span class=hljs-number >0.5</span>])</code></pre><pre><code class="plaintext hljs">2-element Vector{Float64}:
 0.9298091736000003
 0.0546875</code></pre> <p>è¡¨ãŒå‡ºã‚‹ç¢ºç‡Î¸ãŒ0.1ã®æ™‚ã€yãŒ3æœªæº€ã«ãªã‚‹ç¢ºç‡ã¯93&#37;ã§ã€ Î¸&#61;0.5ã®æ™‚ã€yãŒ3æœªæº€ã«ãªã‚‹ç¢ºç‡ã¯5&#37;ã§ã‚ã‚‹ã€‚</p> <h2 id="å‘¨è¾ºåˆ†å¸ƒ"><a href="#å‘¨è¾ºåˆ†å¸ƒ" class=header-anchor >å‘¨è¾ºåˆ†å¸ƒ</a></h2> <p>å‘¨è¾ºåˆ†å¸ƒã®PDFã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><msubsup><mo>âˆ«</mo><mn>0</mn><mn>1</mn></msubsup><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo>âˆ£</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mi>d</mi><mi>Î¸</mi></mrow><annotation encoding="application/x-tex"> p(y)=\int^1_0 p(yâˆ£Î¸)p(Î¸) dÎ¸ </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">âˆ«</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.5640080000000003em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ£</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span></span></span></span></span> <p>ã§ã‚ã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> QuadGK
<span class=hljs-keyword >function</span> marginal(y)
    result, error = quadgk(Î¸-&gt;likelihood_function(y,Î¸)*pdf(prior_dist,Î¸), <span class=hljs-number >0</span>, <span class=hljs-number >1</span>)
    result
<span class=hljs-keyword >end</span>
scatter(<span class=hljs-number >0</span>:<span class=hljs-number >1</span>:<span class=hljs-number >10</span>,y-&gt;marginal(y), label=<span class=hljs-string >&quot;p(y)&quot;</span>, yrotation=<span class=hljs-number >90</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;marginal.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises2_11_1/code/output/marginal.svg" alt=""> <p>ç©åˆ†ã¯QuadGKãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦è¨ˆç®—ã—ãŸã€‚ äº‹å‰åˆ†å¸ƒãŒBeta&#40;4,4&#41;ãªã®ã§ã€y&#61;5&#40;è¡¨ãŒ10å›ä¸­5å›å‡ºã‚‹&#41;ã®ç¢ºç‡ãŒä¸€ç•ªé«˜ã„ã€‚</p> <h2 id="äº‹å¾Œåˆ†å¸ƒ"><a href="#äº‹å¾Œåˆ†å¸ƒ" class=header-anchor >äº‹å¾Œåˆ†å¸ƒ</a></h2> <p>äº‹å¾Œåˆ†å¸ƒã®PDFã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo>âˆ£</mo><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo>âˆ£</mo><mi>Î¸</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>Î¸</mi><mo stretchy=false >)</mo></mrow><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mo stretchy=false >)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex"> p(Î¸âˆ£y)=\frac{p(yâˆ£Î¸)p(Î¸)}{p(y)} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ£</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ£</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=mclose >)</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>ã§è¨ˆç®—ã§ãã‚‹ã€‚</p> <pre><code class="julia hljs">posterior(Î¸)=likelihood_function(Î¸)*pdf(prior_dist,Î¸)/sum(marginal.(<span class=hljs-number >0</span>:<span class=hljs-number >2</span>))
plot(posterior,label=<span class=hljs-string >&quot;posterior(Î¸)&quot;</span>,yrotation=<span class=hljs-number >90</span>)
plot!(prior_dist,label=<span class=hljs-string >&quot;prior(Î¸)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises2_11_1/code/output/posterior.svg" alt=""> <p>äº‹å¾Œåˆ†å¸ƒã¯äº‹å‰åˆ†å¸ƒBeta&#40;4,4&#41;ã«å¯¾ã—ã€ç¢ºç‡ãŒ0æ–¹å‘ã«ãšã‚Œã€åˆ†æ•£ãŒå°ã•ããªã£ã¦ã„ã‚‹ã€‚</p> <h2 id="turingjlã§è§£ã"><a href="#turingjlã§è§£ã" class=header-anchor >Turing.jlã§è§£ã</a></h2> <p>ã“ã®å•é¡Œã‚’Turing.jlã§è§£ãã€‚Turing.jlã¯ãƒ™ã‚¤ã‚ºæ¨å®šç”¨ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã‚ã‚‹ã€‚ Turingã§ã¯yãŒ3æœªæº€ã¨ã„ã†æ¡ä»¶ã‚’èª²ã™ã“ã¨ã¯ã§ããªã„ã€‚ ã—ã‹ã—ã€yã¯å®Ÿæ¸¬å€¤ã§ã‚ã‚Šã€å®Ÿéš›ã«ã¯yãŒ3æœªæº€ã§ã‚ã‚‹ã¨ã„ã†ã“ã¨ã—ã‹ã‚ã‹ã‚‰ãªã„ã“ã¨ã¯ã‚ã‚Šãˆãªã„ã€‚ ä»Šå›ã¯å®Ÿé¨“ã‚’3å›è¡Œã£ã¦å®Ÿæ¸¬å€¤ãŒãã‚Œãã‚Œ0ã€1ã€2ã ã£ãŸå ´åˆã®äº‹å¾Œåˆ†å¸ƒã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Turing, Random
Random.seed!(<span class=hljs-number >1</span>)
<span class=hljs-meta >@model</span> <span class=hljs-keyword >function</span> coin_flip_model(y)
    Î¸ ~ Beta(<span class=hljs-number >4</span>, <span class=hljs-number >4</span>)
    @. y ~ Binomial(<span class=hljs-number >10</span>, Î¸)
<span class=hljs-keyword >end</span>
model = coin_flip_model(<span class=hljs-number >0</span>:<span class=hljs-number >2</span>)
chain = sample(model, NUTS(), <span class=hljs-number >1000</span>)</code></pre><pre><code class="plaintext hljs">Chains MCMC chain (1000Ã—13Ã—1 Array{Float64, 3}):

Iterations        = 501:1:1500
Number of chains  = 1
Samples per chain = 1000
Wall duration     = 10.81 seconds
Compute duration  = 10.81 seconds
parameters        = Î¸
internals         = lp, n_steps, is_accept, acceptance_rate, log_density, hamiltonian_energy, hamiltonian_energy_error, max_hamiltonian_energy_error, tree_depth, numerical_error, step_size, nom_step_size

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   ess_per_sec
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64       Float64

           Î¸    0.1793    0.0594    0.0030   398.5210   595.1723    1.0045       36.8591

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           Î¸    0.0824    0.1373    0.1697    0.2166    0.3230
</code></pre> <p>Î¸ã®äº‹å¾Œåˆ†å¸ƒã¯å¹³å‡0.1819ã€æ¨™æº–åå·®0.0632ã§ã‚ã‚‹ã€‚ 95&#37;ä¿¡ç”¨åŒºé–“ã¯0.0764ã‹ã‚‰0.3252ã§ã‚ã‚‹ã€‚ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚</p> <pre><code class="julia hljs">histogram(chain[:Î¸],normalize=<span class=hljs-literal >true</span>,label=<span class=hljs-string >&quot;simulation&quot;</span>,xlims=(<span class=hljs-number >0</span>,<span class=hljs-number >1</span>))
plot!(posterior,label=<span class=hljs-string >&quot;posterior(Î¸)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;simulation.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises2_11_1/code/output/simulation.svg" alt=""> <p>3å›å®Ÿé¨“ã—ã¦y&#61;0ã€1ã€2ã ã£ãŸæ™‚ã®äº‹å¾Œåˆ†å¸ƒã®æ–¹ãŒã€1å›å®Ÿé¨“ã—ã¦y&lt;3ã ã£ãŸæ™‚ã®äº‹å¾Œåˆ†å¸ƒã‚ˆã‚Šã‚‚ç¢ºç‡ãŒ0ã«å¯„ã£ã¦åˆ†æ•£ã‚‚å°ã•ããªã£ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚</p> <div class=page-foot > <div class=copyright > &copy; dokudo91. Last modified: November 01, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div>