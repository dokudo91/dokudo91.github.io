<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <meta name="twitter:card" content=summary > <meta name="twitter:title" content="Juliaã®ä¸–ç•Œ |&gt; BDA3ã®3.10 Exercisesã®4ã‚’è§£ã"> <meta name="twitter:site" content="@dokudo91"> <meta name="twitter:description" content="BDA3ã®3.10 Exercisesã®4ã‚’è§£ãã€‚"> <meta name="twitter:image" content="https://dokudo91.github.io/assets/ã‚½ãƒ•ã‚£ãƒ¼ã®ä¸–ç•Œ.png"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%220%22 y=%2280%22 font-family=%22Arial%22 font-size=%2285%22>ğŸ˜€</text></svg>"> <title>BDA3ã®3.10 Exercisesã®4ã‚’è§£ã</title> <header> <div class=blog-name ><a href="/">Juliaã®ä¸–ç•Œ</a></div> </header> <div class=franklin-content ><p>BDA3ã®3.10 Exercisesã®4ã‚’è§£ãã€‚ æœ¬æ–‡ã¯<a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a>ã€‚ è§£ç­”å‚è€ƒã¯<a href="http://www.stat.columbia.edu/~gelman/book/BDA3.pdf">Solutions to some exercises from Bayesian Data Analysis</a>ã€‚</p> <h1 id=ol_start4_inference_for_a_2_2_table ><a href="#ol_start4_inference_for_a_2_2_table" class=header-anchor ><ol start=4 > <li><p>Inference for a 2 Ã— 2 table</p> </ol> </a></h1> <p>å¿ƒè‡“ç—…ã«å¯¾ã™ã‚‹æ²»ç™‚ç¾¤ã¨åˆ¶å¾¡ç¾¤ã®æ¯”è¼ƒã‚’è¡Œã†ã€‚</p> <table><tr><th align=right >Group<th align=right >æ‚£è€…æ•°<th align=right >æ­»è€…æ•°<tr><td align=right >åˆ¶å¾¡ç¾¤<td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>0</mn></msub><mo>=</mo><mn>674</mn></mrow><annotation encoding="application/x-tex">n_0=674</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >674</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>0</mn></msub><mo>=</mo><mn>39</mn></mrow><annotation encoding="application/x-tex">y_0=39</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >39</span></span></span></span><tr><td align=right >æ²»ç™‚ç¾¤<td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mn>680</mn></mrow><annotation encoding="application/x-tex">n_1=680</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >680</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mn>22</mn></mrow><annotation encoding="application/x-tex">y_1=22</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >22</span></span></span></span></table> <p>æ­»è€…æ•°yã¯äºŒé …åˆ†å¸ƒBin&#40;n,p&#41;ã«å¾“ã†ã¨ã™ã‚‹ã€‚</p> <h2 id="a_ç„¡æƒ…å ±äº‹å‰åˆ†å¸ƒ"><a href="#a_ç„¡æƒ…å ±äº‹å‰åˆ†å¸ƒ" class=header-anchor >&#40;a&#41; ç„¡æƒ…å ±äº‹å‰åˆ†å¸ƒ</a></h2> <p>æ­»äº¡ç‡pã®äº‹å‰åˆ†å¸ƒã‚’ç„¡æƒ…å ±äº‹å‰åˆ†å¸ƒã¨ã™ã‚‹ã€‚</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub><mo>âˆ¼</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mn>0</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p_0 \sim Beta(0,0) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ¼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >0</span><span class=mclose >)</span></span></span></span></span> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>âˆ¼</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mn>0</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p_1 \sim Beta(0,0) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ¼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >0</span><span class=mclose >)</span></span></span></span></span> <p>pã®äº‹å¾Œåˆ†å¸ƒã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>p</mi><mn>0</mn></msub><mi mathvariant=normal >âˆ£</mi><msub><mi>y</mi><mn>0</mn></msub><mo>âˆ¼</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy=false >(</mo><msub><mi>y</mi><mn>0</mn></msub><mo separator=true >,</mo><msub><mi>n</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p_0|y_0 \sim Beta(y_0,n_0-y_0) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >âˆ£</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ¼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span></span> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>p</mi><mn>1</mn></msub><mi mathvariant=normal >âˆ£</mi><msub><mi>y</mi><mn>1</mn></msub><mo>âˆ¼</mo><mi>B</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo stretchy=false >(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=true >,</mo><msub><mi>n</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p_1|y_1 \sim Beta(y_1,n_1-y_1) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >âˆ£</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ¼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span></span> <p>ã¨ãªã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, StatsPlots
posterior_p0_dist=Beta(<span class=hljs-number >39</span>,<span class=hljs-number >674</span>-<span class=hljs-number >39</span>)
posterior_p1_dist=Beta(<span class=hljs-number >22</span>,<span class=hljs-number >680</span>-<span class=hljs-number >22</span>)
plot(posterior_p0_dist, label=<span class=hljs-string >&quot;control&quot;</span>, yrotation=<span class=hljs-number >90</span>)
plot!(posterior_p1_dist, label=<span class=hljs-string >&quot;treatment&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior_p.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises3_10_4/code/output/posterior_p.svg" alt=""> <h2 id="b_ã‚ªãƒƒã‚ºæ¯”"><a href="#b_ã‚ªãƒƒã‚ºæ¯”" class=header-anchor >&#40;b&#41; ã‚ªãƒƒã‚ºæ¯”</a></h2> <p>ã‚ªãƒƒã‚ºæ¯”ã®åˆ†å¸ƒã‚’èª¿ã¹ã‚‹ã€‚ã‚ªãƒƒã‚ºæ¯”ã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><msub><mi>p</mi><mn>1</mn></msub><mi mathvariant=normal >/</mi><mo stretchy=false >(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>p</mi><mn>1</mn></msub><mo stretchy=false >)</mo></mrow><mrow><msub><mi>p</mi><mn>0</mn></msub><mi mathvariant=normal >/</mi><mo stretchy=false >(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>p</mi><mn>0</mn></msub><mo stretchy=false >)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \frac{p_1/(1-p_1)}{p_0/(1-p_0)} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.363em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>ã¨å®šç¾©ã•ã‚Œã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Random
Random.seed!(<span class=hljs-number >1</span>)
posterior_p0 = rand(posterior_p0_dist,<span class=hljs-number >5000</span>)
posterior_p1 = rand(posterior_p1_dist,<span class=hljs-number >5000</span>)
odds_ratio = (posterior_p1 ./ (<span class=hljs-number >1</span> .- posterior_p1)) ./ (posterior_p0 ./ (<span class=hljs-number >1</span> .- posterior_p0))
histogram(odds_ratio, label=<span class=hljs-string >&quot;odds ratio&quot;</span>, yrotation=<span class=hljs-number >90</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;odds_ratio.svg&quot;</span>))
quantile(odds_ratio, [<span class=hljs-number >.025</span>,<span class=hljs-number >.975</span>])</code></pre><pre><code class="plaintext hljs">2-element Vector{Float64}:
 0.3167444561467876
 0.9064544373929782</code></pre> <img src="/assets/pages/BDA3_Exercises3_10_4/code/output/odds_ratio.svg" alt=""> <p>ã“ã®å›³ã¯ã‚ªãƒƒã‚ºæ¯”ã®ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã§ã‚ã‚‹ã€‚ã‚ªãƒƒã‚ºæ¯”ãŒ1ã®æ™‚ã€æ²»ç™‚ç¾¤ã¨åˆ¶å¾¡ç¾¤ã«é•ã„ãŒãªã„ã¨ã„ã†æ„å‘³ã«ãªã‚‹ã€‚ ã‚ªãƒƒã‚ºæ¯”ãŒ0.5ã§ã‚ã‚Œã°ã€æ²»ç™‚ã¯ä½•ã‚‚ã—ãªã„å ´åˆã¨æ¯”è¼ƒã—ã¦ã€æ­»äº¡æ•°ã‚’1/2ã«æŠ‘ãˆãŸã¨ã„ã†ã“ã¨ã«ãªã‚‹ã€‚</p> <h2 id="c_äº‹å‰åˆ†å¸ƒã«å¯¾ã™ã‚‹æ„Ÿåº¦"><a href="#c_äº‹å‰åˆ†å¸ƒã«å¯¾ã™ã‚‹æ„Ÿåº¦" class=header-anchor >&#40;c&#41; äº‹å‰åˆ†å¸ƒã«å¯¾ã™ã‚‹æ„Ÿåº¦</a></h2> <p>äº‹å‰åˆ†å¸ƒã‚’Beta&#40;2,2&#41;ã«å¤‰ãˆã¦ã¿ã‚‹ã€‚</p> <pre><code class="julia hljs">posterior_p0_alt = rand(Beta(<span class=hljs-number >39</span>+<span class=hljs-number >2</span>,<span class=hljs-number >674</span>-<span class=hljs-number >39</span>+<span class=hljs-number >2</span>),<span class=hljs-number >5000</span>)
posterior_p1_alt = rand(Beta(<span class=hljs-number >22</span>+<span class=hljs-number >2</span>,<span class=hljs-number >680</span>-<span class=hljs-number >22</span>+<span class=hljs-number >2</span>),<span class=hljs-number >5000</span>)
odds_ratio_alt = (posterior_p1_alt ./ (<span class=hljs-number >1</span> .- posterior_p1_alt)) ./ (posterior_p0_alt ./ (<span class=hljs-number >1</span> .- posterior_p0_alt))
histogram(odds_ratio_alt, label=<span class=hljs-string >&quot;odds ratio&quot;</span>, yrotation=<span class=hljs-number >90</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;odds_ratio_alt.svg&quot;</span>))
quantile(odds_ratio_alt, [<span class=hljs-number >.025</span>,<span class=hljs-number >.975</span>])</code></pre><pre><code class="plaintext hljs">2-element Vector{Float64}:
 0.331892554627491
 0.947903256881605</code></pre> <img src="/assets/pages/BDA3_Exercises3_10_4/code/output/odds_ratio_alt.svg" alt=""> <p>95&#37;ä¿¡ç”¨åŒºé–“ã¯&#91;0.32, 0.91&#93;ã‹ã‚‰&#91;0.33, 0.95&#93;ã«ãªã£ã¦å°‘ã—åºƒããªã£ãŸã€‚</p> <div class=page-foot > <div class=copyright > &copy; dokudo91. Last modified: October 19, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div>