<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <meta name="twitter:card" content=summary > <meta name="twitter:title" content="Juliaの世界 |&gt; BDA3の2.11 Exercisesの11を解く"> <meta name="twitter:site" content="@dokudo91"> <meta name="twitter:description" content="BDA3の2.11 Exercisesの11を解く。"> <meta name="twitter:image" content="https://dokudo91.github.io/assets/ソフィーの世界.png"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%220%22 y=%2280%22 font-family=%22Arial%22 font-size=%2285%22>😀</text></svg>"> <title>BDA3の2.11 Exercisesの11を解く</title> <header> <div class=blog-name ><a href="/">Juliaの世界</a></div> </header> <div class=franklin-content ><p>BDA3の2.11 Exercisesの11を解く。 リンクは<a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a>。</p> <h1 id=ol_start11_computing_with_a_nonconjugate_single-parameter_model ><a href="#ol_start11_computing_with_a_nonconjugate_single-parameter_model" class=header-anchor ><ol start=11 > <li><p>Computing with a nonconjugate single-parameter model</p> </ol> </a></h1> <p>y1,...y5はコーシー分布Cauchy&#40;θ,1&#41;からサンプリングされている。 θはコーシー分布の中心である。コーシー分布は平均が定義できないため、中心という言葉を使っている。 yiのPDFは</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=false >)</mo><mo>∝</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo stretchy=false >(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>θ</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex"> p(y_i) ∝ \frac{1}{1+(y_i-θ)^2} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∝</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.25744em;vertical-align:-0.936em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>である。θの事前分布は一様分布Uniform&#40;0,100&#41;とする。</p> <h2 id="コーシー分布"><a href="#コーシー分布" class=header-anchor >コーシー分布</a></h2> <p>コーシー分布は裾の長い分布である。 例えばコンピューターの反応時間をコーシー分布でモデル化できるかもしれない。 多くの場合は、規定時間内に処理が終わるが、他の処理にリソースを多く割いている場合、 処理が完了する時間が非常に長くなる可能性がある。 低確率で平均から離れたことが起こりうる場合、コーシー分布的である。</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, StatsPlots
plot(-<span class=hljs-number >20</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >20</span>,x-&gt;pdf(Cauchy(),x),label=<span class=hljs-string >&quot;Cauchy&quot;</span>,yrotation=<span class=hljs-number >90</span>)
plot!(Normal(),label=<span class=hljs-string >&quot;Normal&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;Cauchy.svg&quot;</span>))
mean(Cauchy()), var(Cauchy())</code></pre><pre><code class="plaintext hljs">(NaN, NaN)</code></pre>
<p>コーシー分布は平均も分散も定義されない。これは裾が非常に重いためである。 <img src="/assets/pages/BDA3_Exercises2_11_11/code/output/Cauchy.svg" alt=""></p>
<p>正規分布と比較し、裾が長いことがわかる。</p>
<h2 id="a_事後分布の計算"><a href="#a_事後分布の計算" class=header-anchor >&#40;a&#41; 事後分布の計算</a></h2>
<p>&#40;y1,...y5&#41;&#61;&#40;43,44,45,46.5,47.5&#41;と観測された。事後分布θ|yはどのような分布になるか？</p>
<p>コーシー分布の中心θの事前分布は一様分布Uniform&#40;0,100&#41;である。θ~Uniform&#40;0,100&#41;。</p>
<pre><code class="julia hljs">prior_pdf(θ)=pdf(Uniform(<span class=hljs-number >0</span>,<span class=hljs-number >100</span>),θ)
prior_pdf(<span class=hljs-number >10</span>), prior_pdf(<span class=hljs-number >85</span>)</code></pre><pre><code class="plaintext hljs">(0.01, 0.01)</code></pre>
<p>尤度関数p&#40;y|θ&#41;は観測値が複数ある場合は全て掛け合わせればよい。</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >∣</mi><mi>θ</mi><mo stretchy=false >)</mo><mo>=</mo><munder><mo>∏</mo><mi>i</mi></munder><mi>p</mi><mo stretchy=false >(</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant=normal >∣</mi><mi>θ</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">
p(y|θ)=\prod_i p(y_i|θ)
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.327674em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0500050000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mclose >)</span></span></span></span></span>
<pre><code class="julia hljs">likelihood_pdf(θ)=prod(pdf.(Cauchy(θ),[<span class=hljs-number >43</span>,<span class=hljs-number >44</span>,<span class=hljs-number >45</span>,<span class=hljs-number >46.5</span>,<span class=hljs-number >47.5</span>]))
plot(<span class=hljs-number >0</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >100</span>,x-&gt;likelihood_pdf(x),label=<span class=hljs-string >&quot;likelihood&quot;</span>,yticks=<span class=hljs-literal >nothing</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;likelihood.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre>
<img src="/assets/pages/BDA3_Exercises2_11_11/code/output/likelihood.svg" alt="">
<p>コーシー分布の中心θの事後分布p&#40;θ|y&#41;は</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>θ</mi><mi mathvariant=normal >∣</mi><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><mfrac><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >∣</mi><mi>θ</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>θ</mi><mo stretchy=false >)</mo></mrow><mrow><mo>∫</mo><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >∣</mi><mi>θ</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>θ</mi><mo stretchy=false >)</mo><mi>d</mi><mi>θ</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">
p(θ|y)=\frac{p(y|θ)p(θ)}{\int p(y|θ)p(θ)dθ}
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.42812em;vertical-align:-1.00112em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.305em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.00112em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
<p>である。</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> QuadGK
unnormalized_posterior_pdf(θ)=prior_pdf(θ)*likelihood_pdf(θ)
marginal_pdf,_=quadgk(unnormalized_posterior_pdf,<span class=hljs-number >0</span>,<span class=hljs-number >100</span>)
posterior_pdf(θ)=unnormalized_posterior_pdf(θ)/marginal_pdf
plot(<span class=hljs-number >0</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >100</span>,posterior_pdf,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;posterior&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre>
<img src="/assets/pages/BDA3_Exercises2_11_11/code/output/posterior.svg" alt="">
<p>積分はQuadGKパッケージを使って行った。</p>
<h2 id="b_事後分布のサンプリング"><a href="#b_事後分布のサンプリング" class=header-anchor >&#40;b&#41; 事後分布のサンプリング</a></h2>
<p>計算した事後分布p&#40;θ|y&#41;から1000個サンプリングを行う。</p>
<pre><code class="julia hljs">posteriorθ_samples=wsample(<span class=hljs-number >0</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >100</span>, posterior_pdf.(<span class=hljs-number >0</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >100</span>), <span class=hljs-number >1000</span>)
posteriorθ_samples[<span class=hljs-number >1</span>:<span class=hljs-number >10</span>]</code></pre><pre><code class="plaintext hljs">10-element Vector{Float64}:
 43.3
 45.3
 45.9
 45.5
 45.2
 44.2
 43.6
 44.3
 44.3
 47.9</code></pre>
<p>サンプリングはMHアルゴリズムでも使った方が良いが、重み付きサンプリング関数wsampleで代用する。</p>
<pre><code class="julia hljs">histogram(posteriorθ_samples,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;posteriorθ_samples&quot;</span>,bins=<span class=hljs-number >40</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;samples.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre>
<img src="/assets/pages/BDA3_Exercises2_11_11/code/output/samples.svg" alt="">
<p>&#91;43,44,45,46.5,47.5&#93;を観測した後の、コーシー分布の中心θの事後分布のヒストグラムを表示している。</p>
<h2 id="c_予測分布ptilde_yy"><a href="#c_予測分布ptilde_yy" class=header-anchor >&#40;c&#41; 予測分布<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mover accent=true ><mi>y</mi><mo>~</mo></mover><mi mathvariant=normal >∣</mi><mi>y</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">p(\tilde y|y)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6678599999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3.35em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.19444em;"><span class=mord >~</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span></span></span></span></a></h2>
<p>&#91;43,44,45,46.5,47.5&#93;を観測した後に、今後観測されると予測されるyを<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>y</mi><mo>~</mo></mover><mi mathvariant=normal >∣</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">\tilde y|y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6678599999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3.35em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.19444em;"><span class=mord >~</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>とする。 予測分布<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mover accent=true ><mi>y</mi><mo>~</mo></mover><mi mathvariant=normal >∣</mi><mi>y</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">p(\tilde y|y)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6678599999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3.35em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.19444em;"><span class=mord >~</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span></span></span></span>は</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mover accent=true ><mi>y</mi><mo>~</mo></mover><mi mathvariant=normal >∣</mi><mi>y</mi><mo stretchy=false >)</mo><mo>=</mo><mo>∫</mo><mi>p</mi><mo stretchy=false >(</mo><mover accent=true ><mi>y</mi><mo>~</mo></mover><mi mathvariant=normal >∣</mi><mi>θ</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>θ</mi><mi mathvariant=normal >∣</mi><mi>y</mi><mo stretchy=false >)</mo><mi>d</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">
p(\tilde y|y)=\int p(\tilde y|θ)p(θ|y)dθ
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6678599999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3.35em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.19444em;"><span class=mord >~</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.22225em;vertical-align:-0.86225em;"></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.6678599999999999em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3.35em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.19444em;"><span class=mord >~</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></span>
<p>で計算できる。 しかし、今回は&#40;b&#41;で作った1000個のサンプルを用いてコーシー分布とフィッテイングを行う。</p>
<pre><code class="julia hljs">posterior_y_dist=fit(Cauchy,posteriorθ_samples)</code></pre><pre><code class="plaintext hljs">Distributions.Cauchy{Float64}(μ=45.0, σ=0.6500000000000021)</code></pre>
<p>中心が45のコーシー分布にfitした。 このコーシー分布を用いて1000個サンプリングを行いヒストグラムで表示する。</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Random
Random.seed!(<span class=hljs-number >1</span>)
ysamples=rand(posterior_y_dist,<span class=hljs-number >1000</span>)
histogram(ysamples,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;posterior_y&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior_y.svg&quot;</span>))
extrema(ysamples)</code></pre><pre><code class="plaintext hljs">(-142.3379453534035, 306.9536439799443)</code></pre>
<img src="/assets/pages/BDA3_Exercises2_11_11/code/output/posterior_y.svg" alt="">
<p>ほとんどは45の周辺であるが、-200から400まで低確率で出現していることがわかる。</p>
<div class=page-foot >
  <div class=copyright >
    &copy; dokudo91. Last modified: October 10, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>