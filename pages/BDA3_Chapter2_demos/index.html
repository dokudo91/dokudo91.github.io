<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <meta name="twitter:card" content=summary > <meta name="twitter:title" content="Juliaã®ä¸–ç•Œ |&gt; BDA3ã®Chapter2ã®ãƒ‡ãƒ¢"> <meta name="twitter:site" content="@dokudo91"> <meta name="twitter:description" content="BDA3ã®Chapter2ã®å†…å®¹ã‚’Juliaã§è¨ˆç®—ã™ã‚‹ã€‚"> <meta name="twitter:image" content="https://dokudo91.github.io/assets/ã‚½ãƒ•ã‚£ãƒ¼ã®ä¸–ç•Œ.png"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%220%22 y=%2280%22 font-family=%22Arial%22 font-size=%2285%22>ğŸ˜€</text></svg>"> <title>BDA3ã®Chapter2ã®ãƒ‡ãƒ¢</title> <header> <div class=blog-name ><a href="/">Juliaã®ä¸–ç•Œ</a></div> </header> <div class=franklin-content ><p>BDA3ã®Chapter2ã®å†…å®¹ã‚’Juliaã§è¨ˆç®—ã™ã‚‹ã€‚ æœ¬æ–‡ã¯<a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a>ã€‚ å‚è€ƒã¯<a href="https://github.com/avehtari/BDA_m_demos/tree/master/demos_ch2">BDA<em>m</em>demos/demos_ch2/</a>ã€‚</p> <h1 id="å‰ç½®èƒç›¤æ¡ä»¶ä¸‹ã§ã®å­ä¾›ã®æ€§åˆ¥"><a href="#å‰ç½®èƒç›¤æ¡ä»¶ä¸‹ã§ã®å­ä¾›ã®æ€§åˆ¥" class=header-anchor >å‰ç½®èƒç›¤æ¡ä»¶ä¸‹ã§ã®å­ä¾›ã®æ€§åˆ¥</a></h1> <p>å‰ç½®èƒç›¤æ¡ä»¶ä¸‹ã§å­ä¾›ã®æ€§åˆ¥ã®çµ±è¨ˆã‚’ã¨ã£ãŸã€‚ ã‚µãƒ³ãƒ—ãƒ«ã‚µã‚¤ã‚ºã¯980ã§å¥³ã®å­ãŒ437ã€ç”·ã®å­ãŒ543ã§ã‚ã£ãŸã€‚ Î¸ã‚’å¥³ã®å­ãŒç”Ÿã¾ã‚Œã‚‹ç¢ºç‡ã¨ã™ã‚‹ã€‚ å¥³ã®å­ã®æ•°ã¯äºŒé …åˆ†å¸ƒBinomial&#40;980,Î¸&#41;ã§ã‚ã‚‹ã€‚ Î¸ã®äº‹å‰åˆ†å¸ƒã‚’å…±å½¹äº‹å‰åˆ†å¸ƒBeta&#40;1,1&#41;ã¨ã™ã‚Œã°äº‹å¾Œåˆ†å¸ƒã¯Beta&#40;1&#43;437,1&#43;543&#41;ã¨ãªã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, StatsPlots
prior_dist = Beta(<span class=hljs-number >1</span>,<span class=hljs-number >1</span>)
posterior_dist = Beta(<span class=hljs-number >1</span>+<span class=hljs-number >437</span>,<span class=hljs-number >1</span>+<span class=hljs-number >543</span>)
plot(prior_dist,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;Beta(1,1)&quot;</span>)
plot!(posterior_dist,label=<span class=hljs-string >&quot;Beta(438,544)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior_dist.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Chapter2_demos/code/output/posterior_dist.svg" alt=""> <h2 id="äº‹å‰åˆ†å¸ƒã®å½±éŸ¿"><a href="#äº‹å‰åˆ†å¸ƒã®å½±éŸ¿" class=header-anchor >äº‹å‰åˆ†å¸ƒã®å½±éŸ¿</a></h2> <p>437/980&#61;0.485ã§ã‚ã‚‹ã®ã§ã€Î¸ã®äº‹å‰åˆ†å¸ƒã‚’Beta&#40;0.485x2,&#40;1-0.485&#41;x2&#41;ã¨ã—ã¦ã¿ã‚‹ã€‚</p> <pre><code class="julia hljs">prior2_dist = Beta(<span class=hljs-number >0.485</span>*<span class=hljs-number >2</span>,(<span class=hljs-number >1</span>-<span class=hljs-number >0.485</span>)*<span class=hljs-number >2</span>)
posterior2_dist = Beta(<span class=hljs-number >0.485</span>*<span class=hljs-number >2</span>+<span class=hljs-number >437</span>,(<span class=hljs-number >1</span>-<span class=hljs-number >0.485</span>)*<span class=hljs-number >2</span>+<span class=hljs-number >543</span>)
plot(prior2_dist,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;Beta(0.485*2,(1-0.485)*2)&quot;</span>)
plot!(posterior2_dist,label=<span class=hljs-string >&quot;Beta(0.485*2+437,(1-0.485)*2+543)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior2_dist.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Chapter2_demos/code/output/posterior2_dist.svg" alt=""> <p>äº‹å‰åˆ†å¸ƒã®å½±éŸ¿ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«Beta&#40;0.485x20,&#40;1-0.485&#41;x20&#41;ã€Beta&#40;0.485x200,&#40;1-0.485&#41;x200&#41;ã¨ ã—ãŸå ´åˆã€ã©ã®ã‚ˆã†ã«ãªã‚‹ã‹ç¢ºèªã™ã‚‹ã€‚</p> <pre><code class="julia hljs">prior3_dist = Beta(<span class=hljs-number >0.485</span>*<span class=hljs-number >20</span>,(<span class=hljs-number >1</span>-<span class=hljs-number >0.485</span>)*<span class=hljs-number >20</span>)
posterior3_dist = Beta(<span class=hljs-number >0.485</span>*<span class=hljs-number >20</span>+<span class=hljs-number >437</span>,(<span class=hljs-number >1</span>-<span class=hljs-number >0.485</span>)*<span class=hljs-number >20</span>+<span class=hljs-number >543</span>)
plot(prior3_dist,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;prior&quot;</span>)
plot!(posterior3_dist,label=<span class=hljs-string >&quot;posterior&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior3_dist.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Chapter2_demos/code/output/posterior3_dist.svg" alt=""> <pre><code class="julia hljs">prior4_dist = Beta(<span class=hljs-number >0.485</span>*<span class=hljs-number >200</span>,(<span class=hljs-number >1</span>-<span class=hljs-number >0.485</span>)*<span class=hljs-number >200</span>)
posterior4_dist = Beta(<span class=hljs-number >0.485</span>*<span class=hljs-number >200</span>+<span class=hljs-number >437</span>,(<span class=hljs-number >1</span>-<span class=hljs-number >0.485</span>)*<span class=hljs-number >200</span>+<span class=hljs-number >543</span>)
plot(prior4_dist,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;prior&quot;</span>)
plot!(posterior4_dist,label=<span class=hljs-string >&quot;posterior&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior4_dist.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Chapter2_demos/code/output/posterior4_dist.svg" alt=""> <h2 id="ä¿¡ç”¨åŒºé–“"><a href="#ä¿¡ç”¨åŒºé–“" class=header-anchor >ä¿¡ç”¨åŒºé–“</a></h2> <p>Beta&#40;1&#43;437,1&#43;543&#41;ã§ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚’è¡Œã†ã€‚</p> <pre><code class="julia hljs">th = rand(posterior_dist,<span class=hljs-number >10000</span>)
histogram(th,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;Beta(1+437,1+543)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;histogram.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Chapter2_demos/code/output/histogram.svg" alt=""> <p>95&#37;ä¿¡ç”¨åŒºé–“ã‚’è¨ˆç®—ã™ã‚‹ã€‚</p> <pre><code class="julia hljs">quantile(posterior_dist,[<span class=hljs-number >.025</span>,<span class=hljs-number >.975</span>])</code></pre><pre><code class="plaintext hljs">2-element Vector{Float64}:
 0.4150654924550012
 0.4771997706294424</code></pre> <h2 id="ç”·å¥³æ¯”"><a href="#ç”·å¥³æ¯”" class=header-anchor >ç”·å¥³æ¯”</a></h2> <p>ä»Šã€ç”·å¥³æ¯”1-Î¸/Î¸ãŒèˆˆå‘³ã®ã‚ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚</p> <pre><code class="julia hljs">phi = (<span class=hljs-number >1</span> .- th) ./ th
histogram(phi,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;1-Î¸/Î¸&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;phi.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Chapter2_demos/code/output/phi.svg" alt=""> <p>95&#37;ä¿¡ç”¨åŒºé–“ã¯</p> <pre><code class="julia hljs">quantile(phi,[<span class=hljs-number >.025</span>,<span class=hljs-number >.975</span>])</code></pre><pre><code class="plaintext hljs">2-element Vector{Float64}:
 1.094402211290062
 1.405644868196633</code></pre> <p>ã§ã‚ã‚‹ã€‚</p> <h2 id="å…±å½¹äº‹å‰åˆ†å¸ƒã§ãªã„äº‹å‰åˆ†å¸ƒ"><a href="#å…±å½¹äº‹å‰åˆ†å¸ƒã§ãªã„äº‹å‰åˆ†å¸ƒ" class=header-anchor >å…±å½¹äº‹å‰åˆ†å¸ƒã§ãªã„äº‹å‰åˆ†å¸ƒ</a></h2> <p>ä»¥ä¸‹ã®ã‚ˆã†ãªäº‹å‰åˆ†å¸ƒã§äº‹å¾Œåˆ†å¸ƒã‚’è¨ˆç®—ã™ã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> noncon_prior_pdf(x)
    <span class=hljs-keyword >if</span> x &lt; <span class=hljs-number >0.385</span>
        x1,y1 = (<span class=hljs-number >0</span>,<span class=hljs-number >1</span>)
        x2,y2 = (<span class=hljs-number >0.385</span>,<span class=hljs-number >1</span>)
    <span class=hljs-keyword >elseif</span> <span class=hljs-number >0.385</span> â‰¤ x &lt; <span class=hljs-number >0.485</span>
        x1,y1 = (<span class=hljs-number >0.385</span>,<span class=hljs-number >1</span>)
        x2,y2 = (<span class=hljs-number >0.485</span>,<span class=hljs-number >11</span>)
    <span class=hljs-keyword >elseif</span> <span class=hljs-number >0.485</span> â‰¤ x &lt; <span class=hljs-number >0.585</span>
        x1,y1 = (<span class=hljs-number >0.485</span>,<span class=hljs-number >11</span>)
        x2,y2 = (<span class=hljs-number >0.585</span>,<span class=hljs-number >1</span>)
    <span class=hljs-keyword >elseif</span> <span class=hljs-number >0.585</span> â‰¤ x
        x1,y1 = (<span class=hljs-number >0.585</span>,<span class=hljs-number >1</span>)
        x2,y2 = (<span class=hljs-number >1</span>,<span class=hljs-number >1</span>)
    <span class=hljs-keyword >end</span>
    a, b = [x1 <span class=hljs-number >1</span>; x2 <span class=hljs-number >1</span>]\[y1; y2]
    a*x + b
<span class=hljs-keyword >end</span>
plot(<span class=hljs-number >0</span>:<span class=hljs-number >0.001</span>:<span class=hljs-number >1</span>, noncon_prior_pdf,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;nonconjugate&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;noncon_prior_pdf.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Chapter2_demos/code/output/noncon_prior_pdf.svg" alt=""> <pre><code class="julia hljs">nonnormalized_posterior_noncon_pdf(x) = pdf(Binomial(<span class=hljs-number >980</span>,x),<span class=hljs-number >437</span>) * noncon_prior_pdf(x)
constant = sum(nonnormalized_posterior_noncon_pdf(x)*<span class=hljs-number >0.001</span> <span class=hljs-keyword >for</span> x <span class=hljs-keyword >in</span> <span class=hljs-number >0</span>:<span class=hljs-number >0.001</span>:<span class=hljs-number >1</span>)
normalized_posterior_noncon_pdf(x) = nonnormalized_posterior_noncon_pdf(x) / constant
plot(<span class=hljs-number >0.3</span>:<span class=hljs-number >0.001</span>:<span class=hljs-number >0.6</span>, normalized_posterior_noncon_pdf,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;nonconjugate&quot;</span>)
plot!(<span class=hljs-number >0.3</span>:<span class=hljs-number >0.001</span>:<span class=hljs-number >0.6</span>, posterior_dist,label=<span class=hljs-string >&quot;conjugate&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;normalized_posterior_noncon_pdf.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Chapter2_demos/code/output/normalized_posterior_noncon_pdf.svg" alt=""> <p>å…±å½¹äº‹å‰åˆ†å¸ƒã§ãªã„æ–¹ã¯å…±å½¹äº‹å‰åˆ†å¸ƒã¨æ¯”ã¹ã¦å¹³å‡ãŒå³ã«ãšã‚Œ,åˆ†æ•£ã‚‚å°ã•ã„ã€‚</p> <h2 id="ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ "><a href="#ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ " class=header-anchor >ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ </a></h2> <pre><code class="julia hljs">s = wsample(<span class=hljs-number >0</span>:<span class=hljs-number >0.001</span>:<span class=hljs-number >1</span>,normalized_posterior_noncon_pdf.(<span class=hljs-number >0</span>:<span class=hljs-number >0.001</span>:<span class=hljs-number >1</span>),<span class=hljs-number >10000</span>)
histogram(s,yrotation=<span class=hljs-number >90</span>,label=<span class=hljs-string >&quot;posterior&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;histogram.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Chapter2_demos/code/output/histogram.svg" alt=""> <div class=page-foot > <div class=copyright > &copy; dokudo91. Last modified: November 14, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div>