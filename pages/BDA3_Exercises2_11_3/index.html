<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <meta name="twitter:card" content=summary > <meta name="twitter:title" content="Juliaの世界 |&gt; BDA3の2.11 Exercisesの3を解く"> <meta name="twitter:site" content="@dokudo91"> <meta name="twitter:description" content="BDA3の2.11 Exercisesの3を解く。"> <meta name="twitter:image" content="https://dokudo91.github.io/assets/ソフィーの世界.png"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%220%22 y=%2280%22 font-family=%22Arial%22 font-size=%2285%22>😀</text></svg>"> <title>BDA3の2.11 Exercisesの3を解く</title> <header> <div class=blog-name ><a href="/">Juliaの世界</a></div> </header> <div class=franklin-content ><p>BDA3の2.11 Exercisesの3を解く。 リンクは<a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a>。</p> <h1 id=ol_start3_predictive_distributions ><a href="#ol_start3_predictive_distributions" class=header-anchor ><ol start=3 > <li><p>Predictive distributions</p> </ol> </a></h1> <p>サイコロを10回振って６が出た回数をyとする。</p> <h2 id="a_yを正規分布で近似する"><a href="#a_yを正規分布で近似する" class=header-anchor >&#40;a&#41; yを正規分布で近似する</a></h2> <p>yは二項分布Binomial&#40;n&#61;1000, p&#61;1/6&#41;に従う。二項分布の平均<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">μ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span>はnpであり、分散<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">σ^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>はnp&#40;1-p&#41;である。 yを正規分布近似すると<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Normal</mtext><mo stretchy=false >(</mo><mi>n</mi><mi>p</mi><mo separator=true >,</mo><msqrt><mrow><mi>n</mi><mi>p</mi><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy=false >)</mo></mrow></msqrt><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\text{Normal}(np,\sqrt{np(1-p)})</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.24em;vertical-align:-0.30499999999999994em;"></span><span class="mord text"><span class=mord >Normal</span></span><span class=mopen >(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">p</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.935em;"><span class=svg-align  style="top:-3.2em;"><span class=pstrut  style="height:3.2em;"></span><span class=mord  style="padding-left:1em;"><span class="mord mathnormal">n</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">p</span><span class=mclose >)</span></span></span><span style="top:-2.8950000000000005em;"><span class=pstrut  style="height:3.2em;"></span><span class=hide-tail  style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.30499999999999994em;"><span></span></span></span></span></span><span class=mclose >)</span></span></span></span>となる。</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, StatsPlots
meany=<span class=hljs-number >1000</span>*<span class=hljs-number >1</span>/<span class=hljs-number >6</span>
stdy=sqrt(<span class=hljs-number >1000</span>*<span class=hljs-number >1</span>/<span class=hljs-number >6</span>*(<span class=hljs-number >1</span>-<span class=hljs-number >1</span>/<span class=hljs-number >6</span>))
nay=Normal(meany,stdy)
plot(nay,label=<span class=hljs-string >&quot;Normal&quot;</span>,yrotation=<span class=hljs-number >90</span>)
plot!(Binomial(<span class=hljs-number >1000</span>,<span class=hljs-number >1</span>/<span class=hljs-number >6</span>),label=<span class=hljs-string >&quot;Binomial(1000,1/6)&quot;</span>,xlims=(<span class=hljs-number >100</span>,<span class=hljs-number >250</span>))
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;Binomial.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises2_11_3/code/output/Binomial.svg" alt=""> <p>二項分布を正規分布でよく近似できていることがわかる。</p> <h2 id="b_分位数を計算する"><a href="#b_分位数を計算する" class=header-anchor >&#40;b&#41; 分位数を計算する</a></h2> <p>分位数はquantileを使って計算する。正規分布近似の分位数は</p> <pre><code class="julia hljs">q = [<span class=hljs-number >0.05</span>,<span class=hljs-number >0.25</span>,<span class=hljs-number >0.5</span>,<span class=hljs-number >0.75</span>,<span class=hljs-number >0.95</span>]
nayq = quantile(nay, q)</code></pre><pre><code class="plaintext hljs">5-element Vector{Float64}:
 147.28188077205542
 158.71772872992548
 166.66666666666666
 174.61560460340783
 186.05145256127787</code></pre> <p>となる。二項分布の分位数は</p> <pre><code class="julia hljs">yq = quantile(Binomial(<span class=hljs-number >1000</span>,<span class=hljs-number >1</span>/<span class=hljs-number >6</span>), q)</code></pre><pre><code class="plaintext hljs">5-element Vector{Int64}:
 147
 159
 167
 175
 186</code></pre> <p>となる。表でまとめると</p> <pre><code class="julia hljs">csv=<span class=hljs-string >&quot;&quot;&quot;分位数,<span class=hljs-subst >$(join(q,<span class=hljs-string >&quot;,&quot;</span>)</span>)
正規分布近似,<span class=hljs-subst >$(join(round.(nayq;digits=<span class=hljs-number >2</span>)</span>,&quot;,&quot;))
二項分布,<span class=hljs-subst >$(join(yq,<span class=hljs-string >&quot;,&quot;</span>)</span>)&quot;&quot;&quot;</span>
write(joinpath(<span class=hljs-meta >@OUTPUT</span>,<span class=hljs-string >&quot;quantile.csv&quot;</span>), csv)
<span class=hljs-literal >nothing</span></code></pre> <table><tr><th align=right >分位数<th align=right >0.05<th align=right >0.25<th align=right >0.5<th align=right >0.75<th align=right >0.95<tr><td align=right >正規分布近似<td align=right >147.28<td align=right >158.72<td align=right >166.67<td align=right >174.62<td align=right >186.05<tr><td align=right >二項分布<td align=right >147<td align=right >159<td align=right >167<td align=right >175<td align=right >186</table> <p>となる。二項分布が正規分布で近似できるのは中心極限定理のためである。</p> <div class=page-foot > <div class=copyright > &copy; dokudo91. Last modified: October 02, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div>