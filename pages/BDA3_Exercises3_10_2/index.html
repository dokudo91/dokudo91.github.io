<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <meta name="twitter:card" content=summary > <meta name="twitter:title" content="Juliaã®ä¸–ç•Œ |&gt; BDA3ã®3.10 Exercisesã®2ã‚’è§£ã"> <meta name="twitter:site" content="@dokudo91"> <meta name="twitter:description" content="BDA3ã®3.10 Exercisesã®2ã‚’è§£ãã€‚"> <meta name="twitter:image" content="https://dokudo91.github.io/assets/ã‚½ãƒ•ã‚£ãƒ¼ã®ä¸–ç•Œ.png"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%220%22 y=%2280%22 font-family=%22Arial%22 font-size=%2285%22>ğŸ˜€</text></svg>"> <title>BDA3ã®3.10 Exercisesã®2ã‚’è§£ã</title> <header> <div class=blog-name ><a href="/">Juliaã®ä¸–ç•Œ</a></div> </header> <div class=franklin-content ><p>BDA3ã®3.10 Exercisesã®2ã‚’è§£ãã€‚ æœ¬æ–‡ã¯<a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a>ã€‚ è§£ç­”å‚è€ƒã¯<a href="http://www.stat.columbia.edu/~gelman/book/BDA3.pdf">Solutions to some exercises from Bayesian Data Analysis</a>ã€‚</p> <h1 id=ol_start2_comparison_of_two_multinomial_observations ><a href="#ol_start2_comparison_of_two_multinomial_observations" class=header-anchor ><ol start=2 > <li><p>Comparison of two multinomial observations</p> </ol> </a></h1> <p>Bushã¨DukakisãŒãƒ‡ã‚£ãƒ™ãƒ¼ãƒˆã‚’è¡Œã£ãŸã€‚ ãã®ãƒ‡ã‚£ãƒ™ãƒ¼ãƒˆã®å‰ã¨å¾Œã«ã©ã¡ã‚‰ã‚’æ”¯æŒã™ã‚‹ã‹èª¿æŸ»ã‚’è¡Œãªã£ã¦ã„ã‚‹ã€‚</p> <table><tr><th align=right >Survey<th align=right >Bush<th align=right >Dukakis<th align=right >No opinion/other<th align=right >Total<tr><td align=right >pre-debate<td align=right >294<td align=right >307<td align=right >38<td align=right >639<tr><td align=right >post-debate<td align=right >288<td align=right >332<td align=right >19<td align=right >639</table> <p>Bushã®æ”¯æŒç‡ã€Dukakisã®æ”¯æŒç‡ã€ãã®ä»–ã®å‰²åˆã®äº‹å‰åˆ†å¸ƒã‚’ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã¨ã—ã€ Bushã®æ”¯æŒæ•°ã€Dukakisã®æ”¯æŒæ•°ã€ãã®ä»–ã®æ•°ã‚’å¤šé …åˆ†å¸ƒã¨ã™ã‚‹ã€‚ äº‹å¾Œåˆ†å¸ƒã¯<a href=BDA3_Exercises3_10_1 >Exercises 3.10ã®1</a>ã§æ±‚ã‚ãŸã‚ˆã†ã« <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant=normal >D</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >h</mi><mi mathvariant=normal >l</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi></mrow><mo stretchy=false >(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=true >,</mo><mo>â€¦</mo><mo separator=true >,</mo><msub><mi>y</mi><mi>J</mi></msub><mo>+</mo><msub><mi>a</mi><mi>J</mi></msub><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\mathrm{Dirichlet}(y_1+a_1,\dots,y_J+a_J)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">Dirichlet</span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner >â€¦</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span>ã¨ãªã‚‹ã€‚ äº‹å‰åˆ†å¸ƒã«é–¢ã™ã‚‹æƒ…å ±ã¯ä½•ã‚‚ãªã„ã®ã§ã€<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><mo>=</mo><msub><mi>a</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a_1=a_2=a_3=1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">a</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>ã¨ã™ã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> DataFrames, CSV
io=<span class=hljs-built_in >IOBuffer</span>(<span class=hljs-string >&quot;&quot;&quot;
Bush Dukakis other
294 307 38
288 332 19
&quot;&quot;&quot;</span>)
df = CSV.File(io, delim = <span class=hljs-string >&#x27; &#x27;</span>, header=<span class=hljs-literal >true</span>) |&gt; DataFrame</code></pre><pre><code class="plaintext hljs">2Ã—3 DataFrame
 Row â”‚ Bush   Dukakis  other
     â”‚ Int64  Int64    Int64
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   1 â”‚   294      307     38
   2 â”‚   288      332     19</code></pre> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions
posterior_dists=Dirichlet.([collect(df[i,:]) .+ <span class=hljs-number >1</span> <span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >2</span>])</code></pre><pre><code class="plaintext hljs">2-element Vector{Distributions.Dirichlet{Int64, Vector{Int64}, Float64}}:
 Distributions.Dirichlet{Int64, Vector{Int64}, Float64}(alpha=[295, 308, 39])
 Distributions.Dirichlet{Int64, Vector{Int64}, Float64}(alpha=[289, 333, 20])</code></pre> <p>è¡¨ã®å€¤ã‹ã‚‰ãƒ‡ã‚£ãƒ™ãƒ¼ãƒˆå‰ã¨ãƒ‡ã‚£ãƒ™ãƒ¼ãƒˆå¾Œã®æ”¯æŒç‡ã®ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã‚’ãã‚Œãã‚Œä½œã£ãŸã€‚ alpha&#61;&#91;295, 308, 39&#93;ã¨alpha&#61;&#91;289, 333, 20&#93;ã«ãªã£ã¦ã„ã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> predict(dist)
    Î¸s = rand(dist)
    rand(Multinomial(<span class=hljs-number >639</span>, Î¸s))
<span class=hljs-keyword >end</span>
Î¸s = rand(posterior_dists[<span class=hljs-number >1</span>])
<span class=hljs-meta >@show</span> Î¸s
rand(Multinomial(<span class=hljs-number >639</span>, Î¸s))</code></pre><pre><code class="plaintext hljs">Î¸s = [0.4383816540870331, 0.5007852410835884, 0.060833104829378565]
3-element Vector{Int64}:
 265
 332
  42</code></pre> <p>ã“ã®å€¤ã¯æ”¯æŒç‡ã®äº‹å¾Œåˆ†å¸ƒã§ã‚ã‚‹ãƒ‡ã‚£ãƒªã‚¯ãƒ¬åˆ†å¸ƒã‹ã‚‰Î¸ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã€ãã‚Œã‚’å…ƒã«å¤šé …åˆ†å¸ƒã‚’ç”Ÿæˆã—ã€639äººã‚’æŒ¯ã‚Šåˆ†ã‘ãŸã‚‚ã®ã§ã‚ã‚‹ã€‚</p> <p>ã“ã®ä½œæ¥­ã‚’1000å›è¡Œãªã£ã¦ãã®ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’è¡¨ç¤ºã™ã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> StatsPlots
posterior1_predicts = [predict(posterior_dists[<span class=hljs-number >1</span>]) <span class=hljs-keyword >for</span> _ <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >5000</span>]
yBush1=getindex.(posterior1_predicts, <span class=hljs-number >1</span>)
yDukakis1=getindex.(posterior1_predicts, <span class=hljs-number >2</span>)
stephist(yBush1, label=<span class=hljs-string >&quot;pre-debate Bush&quot;</span>, xlim=(<span class=hljs-number >220</span>,<span class=hljs-number >380</span>), yrotation=<span class=hljs-number >90</span>)
stephist!(yDukakis1, label=<span class=hljs-string >&quot;pre-debate Dukakis&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior1.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises3_10_2/code/output/posterior1.svg" alt=""> <pre><code class="julia hljs">posterior2_predicts = [predict(posterior_dists[<span class=hljs-number >2</span>]) <span class=hljs-keyword >for</span> _ <span class=hljs-keyword >in</span> <span class=hljs-number >1</span>:<span class=hljs-number >5000</span>]
yBush2=getindex.(posterior2_predicts, <span class=hljs-number >1</span>)
yDukakis2=getindex.(posterior2_predicts, <span class=hljs-number >2</span>)
stephist(yBush2, label=<span class=hljs-string >&quot;post-debate Bush&quot;</span>, xlim=(<span class=hljs-number >220</span>,<span class=hljs-number >380</span>), yrotation=<span class=hljs-number >90</span>)
stephist!(yDukakis2, label=<span class=hljs-string >&quot;post-debate Dukakis&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior2.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises3_10_2/code/output/posterior2.svg" alt=""> <h2 id="æ”¯æŒç‡ã®å·®"><a href="#æ”¯æŒç‡ã®å·®" class=header-anchor >æ”¯æŒç‡ã®å·®</a></h2> <p>Bushã¨Dukakisã®æ”¯æŒç‡ã«ã®ã¿æ³¨ç›®ã™ã‚‹ã€‚</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>Î±</mi><mn>1</mn></msub><mo>=</mo><mfrac><msubsup><mi>Î¸</mi><mn>1</mn><mrow><mi>p</mi><mi>r</mi><mi>e</mi></mrow></msubsup><mrow><msubsup><mi>Î¸</mi><mn>1</mn><mrow><mi>p</mi><mi>r</mi><mi>e</mi></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mn>2</mn><mrow><mi>p</mi><mi>r</mi><mi>e</mi></mrow></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex"> Î±_1=\frac{Î¸^{pre}_1}{Î¸^{pre}_1+Î¸^{pre}_2} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.411608em;vertical-align:-0.952308em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.4593em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.7823em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">re</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.7823em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">re</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.7823em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">re</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.952308em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>Î±</mi><mn>2</mn></msub><mo>=</mo><mfrac><msubsup><mi>Î¸</mi><mn>1</mn><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></msubsup><mrow><msubsup><mi>Î¸</mi><mn>1</mn><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></msubsup><mo>+</mo><msubsup><mi>Î¸</mi><mn>2</mn><mrow><mi>p</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex"> Î±_2=\frac{Î¸^{post}_1}{Î¸^{post}_1+Î¸^{post}_2} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.656236em;vertical-align:-1.067772em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.588464em;"><span style="top:-2.198536em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9114639999999999em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9114639999999999em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9114639999999999em;"><span style="top:-2.433692em;margin-left:-0.02778em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1809080000000005em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.266308em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.067772em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>ã¨ã™ã‚‹ã€‚<a href=BDA3_Exercises3_10_1 >Exercises 3.10ã®1</a>ã§æ±‚ã‚ãŸã‚ˆã†ã«äº‹å¾Œåˆ†å¸ƒã¯ãã‚Œãã‚Œ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mn>1</mn></msub><mi mathvariant=normal >âˆ£</mi><mi>y</mi><mo>=</mo><mrow><mi mathvariant=normal >B</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow><mo stretchy=false >(</mo><mn>295</mn><mo separator=true >,</mo><mn>308</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">Î±_1|y=\mathrm{Beta}(295,308)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >âˆ£</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">Beta</span></span><span class=mopen >(</span><span class=mord >295</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >308</span><span class=mclose >)</span></span></span></span>ã€<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mn>2</mn></msub><mi mathvariant=normal >âˆ£</mi><mi>y</mi><mo>=</mo><mrow><mi mathvariant=normal >B</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi></mrow><mo stretchy=false >(</mo><mn>289</mn><mo separator=true >,</mo><mn>333</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">Î±_2|y=\mathrm{Beta}(289,333)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >âˆ£</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathrm">Beta</span></span><span class=mopen >(</span><span class=mord >289</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >333</span><span class=mclose >)</span></span></span></span>ã¨ãªã‚‹ã€‚</p> <pre><code class="julia hljs">Î±<span class=hljs-number >1_</span>dist=Beta(<span class=hljs-number >295</span>,<span class=hljs-number >308</span>)
Î±<span class=hljs-number >2_</span>dist=Beta(<span class=hljs-number >289</span>,<span class=hljs-number >333</span>)
plot(Î±<span class=hljs-number >1_</span>dist, label=<span class=hljs-string >&quot;pre-debate Bush&quot;</span>, yrotation=<span class=hljs-number >90</span>)
plot!(Î±<span class=hljs-number >2_</span>dist, label=<span class=hljs-string >&quot;post-debate Bush&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;Î±_dist.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises3_10_2/code/output/Î±_dist.svg" alt=""> <p>ã“ã®ç¢ºç‡Î±ã¯Bushã¨Dukakisã®æ”¯æŒç‡ã‚’å…¨ä½“ã¨ã—ãŸã‚‚ã®ã¨ãªã‚‹ã€‚&#40;1-Î±ãŒDukakisã®æ”¯æŒç‡ã«ãªã‚‹ã€‚&#41; ãã®å·®<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>Î±</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">Î±_2-Î±_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã®ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’æ±‚ã‚ã‚‹ã€‚</p> <pre><code class="julia hljs">dif = rand(Î±<span class=hljs-number >2_</span>dist, <span class=hljs-number >5000</span>) .- rand(Î±<span class=hljs-number >1_</span>dist, <span class=hljs-number >5000</span>)
histogram(dif, label=<span class=hljs-string >&quot;Î±2 - Î±1&quot;</span>, yrotation=<span class=hljs-number >90</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;dif.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises3_10_2/code/output/dif.svg" alt=""> <p>ãƒ‡ã‚£ãƒ™ãƒ¼ãƒˆå¾Œã«Bushå´ãŒæ”¯æŒç‡ã‚’å¢—ã‚„ã—ãŸã¨æ¨æ¸¬ã™ã‚‹äº‹å¾Œåˆ†å¸ƒã¯<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î±</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>Î±</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Î±_2-Î±_1&gt;0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.73333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.6891em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>ã¨ãªã‚‹å‰²åˆã‚’è€ƒãˆã‚Œã°ã‚ˆã„ã€‚</p> <pre><code class="julia hljs">count(&gt;(<span class=hljs-number >0</span>), dif) / length(dif)</code></pre><pre><code class="plaintext hljs">0.1934</code></pre>
<p>ãƒ‡ã‚£ãƒ™ãƒ¼ãƒˆã¯ç´„19&#37;ã®ç¢ºç‡ã§Bushã«æœ‰åˆ©ã«åƒã„ãŸã¨æ¨æ¸¬ã—ã¦ã„ã‚‹ã€‚</p>
<div class=page-foot >
  <div class=copyright >
    &copy; dokudo91. Last modified: October 16, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>