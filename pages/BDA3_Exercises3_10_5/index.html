<!doctype html> <html lang=ja > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <meta name="twitter:card" content=summary > <meta name="twitter:title" content="Juliaã®ä¸–ç•Œ |&gt; BDA3ã®3.10 Exercisesã®4ã‚’è§£ã"> <meta name="twitter:site" content="@dokudo91"> <meta name="twitter:description" content="BDA3ã®3.10 Exercisesã®4ã‚’è§£ãã€‚"> <meta name="twitter:image" content="https://dokudo91.github.io/assets/ã‚½ãƒ•ã‚£ãƒ¼ã®ä¸–ç•Œ.png"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%220%22 y=%2280%22 font-family=%22Arial%22 font-size=%2285%22>ğŸ˜€</text></svg>"> <title>BDA3ã®3.10 Exercisesã®4ã‚’è§£ã</title> <header> <div class=blog-name ><a href="/">Juliaã®ä¸–ç•Œ</a></div> </header> <div class=franklin-content ><p>BDA3ã®3.10 Exercisesã®4ã‚’è§£ãã€‚ æœ¬æ–‡ã¯<a href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis</a>ã€‚ è§£ç­”å‚è€ƒã¯<a href="http://www.stat.columbia.edu/~gelman/book/BDA3.pdf">Solutions to some exercises from Bayesian Data Analysis</a>ã€‚</p> <h1 id=ol_start5_rounded_data ><a href="#ol_start5_rounded_data" class=header-anchor ><ol start=5 > <li><p>Rounded data</p> </ol> </a></h1> <p>å·¥å ´ã§5ã¤ã®è£½å“ã®é‡ã•ã‚’æ¸¬ã£ãŸã€‚ ãã®å€¤ã¯å››æ¨äº”å…¥ã—ã¦ã€y&#61;&#91;10, 10, 12, 11, 9&#93;ã ã£ãŸã€‚ å››æ¨äº”å…¥ã—ãªã„æœ¬å½“ã®é‡ã•ã¯æ­£è¦åˆ†å¸ƒ<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy=false >(</mo><mi>Î¼</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">N(Î¼,Ïƒ^2)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mopen >(</span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span>ã«å¾“ã£ã¦ã„ã‚‹ã¨ã™ã‚‹ã€‚ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Î¼,Ïƒ^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>ã®äº‹å‰åˆ†å¸ƒã¯ç„¡æƒ…å ±äº‹å‰åˆ†å¸ƒã¨ã™ã‚‹ã€‚</p> <h2 id="a_yãŒæ­£ç¢ºãªå€¤ã ã£ãŸå ´åˆ"><a href="#a_yãŒæ­£ç¢ºãªå€¤ã ã£ãŸå ´åˆ" class=header-anchor >&#40;a&#41; yãŒæ­£ç¢ºãªå€¤ã ã£ãŸå ´åˆ</a></h2> <p>y&#61;&#91;10, 10, 12, 11, 9&#93;ã¨å®Ÿéš›ã«è¦³æ¸¬ã•ã‚ŒãŸã¨ã™ã‚‹ã€‚ æœ¬æ–‡p.65ã‚ˆã‚Š</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mtext>Âµ</mtext><mi mathvariant=normal >âˆ£</mi><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo separator=true >,</mo><mi>y</mi><mo>âˆ¼</mo><mi>N</mi><mo stretchy=false >(</mo><mi>y</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mi mathvariant=normal >/</mi><mi>n</mi><mo stretchy=false >)</mo><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> Âµ|Ïƒ^2, y \sim N(y, Ïƒ^2/n). </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class=mord >Âµâˆ£</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ¼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord >/</span><span class="mord mathnormal">n</span><span class=mclose >)</span><span class=mord >.</span></span></span></span></span> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup><mi mathvariant=normal >âˆ£</mi><mi>y</mi><mo>âˆ¼</mo><mtext>Inv-</mtext><msup><mi>Ï‡</mi><mn>2</mn></msup><mo stretchy=false >(</mo><mi>n</mi><mtext>âˆ’</mtext><mn>1</mn><mo separator=true >,</mo><msup><mi>s</mi><mn>2</mn></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> Ïƒ^2|y \sim \text{Inv-}Ï‡^2(n âˆ’ 1, s^2) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord >âˆ£</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ¼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord text"><span class=mord >Inv-</span></span><span class=mord ><span class="mord mathnormal">Ï‡</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">n</span><span class=mord >âˆ’1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span></span> <p>ã§ã‚ã‚‹ã€‚ã“ã“ã§<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>s</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">s^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>ã¯ã‚µãƒ³ãƒ—ãƒ«åˆ†æ•£ã§ã‚ã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> Distributions, StatsPlots
y=[<span class=hljs-number >10</span>, <span class=hljs-number >10</span>, <span class=hljs-number >12</span>, <span class=hljs-number >11</span>, <span class=hljs-number >9</span>]
posterior_variance_a_dist = InverseGamma((length(y)-<span class=hljs-number >1</span>)//<span class=hljs-number >2</span>, <span class=hljs-number >1</span>//<span class=hljs-number >2</span>) * std(y)
plot(posterior_variance_a_dist, label=<span class=hljs-string >&quot;posterior variance&quot;</span>, yrotation=<span class=hljs-number >90</span>, xlim=(<span class=hljs-number >0</span>,<span class=hljs-number >4</span>))
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior_variance_a_dist.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <img src="/assets/pages/BDA3_Exercises3_10_5/code/output/posterior_variance_a_dist.svg" alt=""> <p>å›³ã¯<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup><mi mathvariant=normal >âˆ£</mi><mi>y</mi><mo>âˆ¼</mo><mtext>Inv-</mtext><msup><mi>Ï‡</mi><mn>2</mn></msup><mo stretchy=false >(</mo><mi>n</mi><mtext>âˆ’</mtext><mn>1</mn><mo separator=true >,</mo><msup><mi>s</mi><mn>2</mn></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">Ïƒ^2|y \sim \text{Inv-}Ï‡^2(n âˆ’ 1, s^2)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord >âˆ£</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ¼</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord text"><span class=mord >Inv-</span></span><span class=mord ><span class="mord mathnormal">Ï‡</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">n</span><span class=mord >âˆ’1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal">s</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span>ã®ç¢ºç‡å¯†åº¦é–¢æ•°ã§ã‚ã‚‹ã€‚ ã“ã®æ™‚ã€Î¼ã®äº‹å¾Œåˆ†å¸ƒã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã€‚</p> <pre><code class="julia hljs">posterior_variance_a = rand(posterior_variance_a_dist, <span class=hljs-number >10</span>)
posterior_mean_a_dist = Normal.(mean(y),posterior_variance_a)
plot(posterior_mean_a_dist, yrotation=<span class=hljs-number >90</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;posterior_mean_a_dist.svg&quot;</span>))
posterior_variance_a</code></pre><pre><code class="plaintext hljs">10-element Vector{Float64}:
 0.44317395820070854
 0.2079420239077438
 0.5179739673225474
 0.3948739465593943
 2.3439437615331356
 1.1474145977958756
 0.382893376700611
 0.2394708571613967
 0.2644657222770382
 1.2236804846988694</code></pre> <p>ã“ã®å€¤ã¯åˆ†æ•£ã®äº‹å¾Œåˆ†å¸ƒã‹ã‚‰å¾—ã‚‰ã‚ŒãŸå€¤ã§ã‚ã‚‹ã€‚ <img src="/assets/pages/BDA3_Exercises3_10_5/code/output/posterior_mean_a_dist.svg" alt=""></p> <h2 id="b_yãŒå››æ¨äº”å…¥ã—ãŸå€¤ã ã£ãŸå ´åˆ"><a href="#b_yãŒå››æ¨äº”å…¥ã—ãŸå€¤ã ã£ãŸå ´åˆ" class=header-anchor >&#40;b&#41; yãŒå››æ¨äº”å…¥ã—ãŸå€¤ã ã£ãŸå ´åˆ</a></h2> <p>Î¼ã¨Ïƒã®äº‹å¾Œåˆ†å¸ƒã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>Î¼</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mi mathvariant=normal >âˆ£</mi><mi>y</mi><mo stretchy=false >)</mo><mo>âˆ</mo><mi>p</mi><mo stretchy=false >(</mo><mi>Î¼</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >âˆ£</mi><mi>Î¼</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(Î¼,Ïƒ^2|y)âˆp(Î¼,Ïƒ^2)p(y|Î¼,Ïƒ^2) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord >âˆ£</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >âˆ£</span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span></span> <p>ã§ã‚ã‚‹ã€‚äº‹å‰åˆ†å¸ƒp&#40;Î¼,Ïƒ^2&#41;ã¯ç„¡æƒ…å ±äº‹å‰åˆ†å¸ƒãªã®ã§</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>Î¼</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy=false >)</mo><mo>=</mo><msup><mi>Ïƒ</mi><mrow><mo>âˆ’</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex"> p(Î¼,Ïƒ^2)=Ïƒ^{-2} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.864108em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span> <p>ã§ã‚ã‚‹ã€‚</p> <p>yãŒ10ã®æ™‚ã€è€ƒãˆã†ã‚‹å€¤ã¯9.5â‰¤y&lt;10.5ã§ã‚ã‚‹ã€‚ yã¯æ­£è¦åˆ†å¸ƒã«å¾“ã£ã¦ã„ã‚‹ã®ã§ã€ã“ã®ç¯„å›²å†…ã«å…¥ã‚‹ç¢ºç‡ã¯</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >âˆ£</mi><mi>Î¼</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy=false >)</mo><mo>âˆ</mo><mi mathvariant=normal >Î¦</mi><mo stretchy=false >(</mo><mfrac><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><mn>0.5</mn><mo>âˆ’</mo><mi>Î¼</mi></mrow><mi>Ïƒ</mi></mfrac><mo stretchy=false >)</mo><mo>âˆ’</mo><mi mathvariant=normal >Î¦</mi><mo stretchy=false >(</mo><mfrac><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo>âˆ’</mo><mi>Î¼</mi></mrow><mi>Ïƒ</mi></mfrac><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(y|Î¼,Ïƒ^2)âˆÎ¦(\frac{y_i+0.5-Î¼}{Ïƒ})-Î¦(\frac{y_i-0.5-Î¼}{Ïƒ}) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >âˆ£</span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord >Î¦</span><span class=mopen >(</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >0.5</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord >Î¦</span><span class=mopen >(</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >0.5</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose >)</span></span></span></span></span> <p>ã§ã‚ã‚‹ã€‚yãŒnå€‹è¦³æ¸¬ã•ã‚ŒãŸå ´åˆã¯å…¨ã¦ã‚’ã‹ã‘ã¦</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>y</mi><mi mathvariant=normal >âˆ£</mi><mi>Î¼</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy=false >)</mo><mo>âˆ</mo><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=false >(</mo><mi mathvariant=normal >Î¦</mi><mo stretchy=false >(</mo><mfrac><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><mn>0.5</mn><mo>âˆ’</mo><mi>Î¼</mi></mrow><mi>Ïƒ</mi></mfrac><mo stretchy=false >)</mo><mo>âˆ’</mo><mi mathvariant=normal >Î¦</mi><mo stretchy=false >(</mo><mfrac><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo>âˆ’</mo><mi>Î¼</mi></mrow><mi>Ïƒ</mi></mfrac><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(y|Î¼,Ïƒ^2)âˆ\prod^n_{i=1}(Î¦(\frac{y_i+0.5-Î¼}{Ïƒ})-Î¦(\frac{y_i-0.5-Î¼}{Ïƒ})) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mord >âˆ£</span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mopen >(</span><span class=mord >Î¦</span><span class=mopen >(</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >0.5</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord >Î¦</span><span class=mopen >(</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >0.5</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose >))</span></span></span></span></span> <p>ã¨ãªã‚‹ã€‚ &#40;3&#41;,&#40;4&#41;,&#40;6&#41;å¼ã‚ˆã‚Š</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>Î¼</mi><mo separator=true >,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mi mathvariant=normal >âˆ£</mi><mi>y</mi><mo stretchy=false >)</mo><mo>âˆ</mo><msup><mi>Ïƒ</mi><mrow><mo>âˆ’</mo><mn>2</mn></mrow></msup><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=false >(</mo><mi mathvariant=normal >Î¦</mi><mo stretchy=false >(</mo><mfrac><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>+</mo><mn>0.5</mn><mo>âˆ’</mo><mi>Î¼</mi></mrow><mi>Ïƒ</mi></mfrac><mo stretchy=false >)</mo><mo>âˆ’</mo><mi mathvariant=normal >Î¦</mi><mo stretchy=false >(</mo><mfrac><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>âˆ’</mo><mn>0.5</mn><mo>âˆ’</mo><mi>Î¼</mi></mrow><mi>Ïƒ</mi></mfrac><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex"> p(Î¼,Ïƒ^2|y)âˆÏƒ^{-2}\prod^n_{i=1}(Î¦(\frac{y_i+0.5-Î¼}{Ïƒ})-Î¦(\frac{y_i-0.5-Î¼}{Ïƒ})) </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord >âˆ£</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.929066em;vertical-align:-1.277669em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class=pstrut  style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class=pstrut  style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:1.277669em;"><span></span></span></span></span></span><span class=mopen >(</span><span class=mord >Î¦</span><span class=mopen >(</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >0.5</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.00744em;vertical-align:-0.686em;"></span><span class=mord >Î¦</span><span class=mopen >(</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord >0.5</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">Î¼</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mclose >))</span></span></span></span></span> <h1 id="c_aã¨bã®åˆ†å¸ƒã®æ¯”è¼ƒ"><a href="#c_aã¨bã®åˆ†å¸ƒã®æ¯”è¼ƒ" class=header-anchor >&#40;c&#41; &#40;a&#41;ã¨&#40;b&#41;ã®åˆ†å¸ƒã®æ¯”è¼ƒ</a></h1> <p>æ¨ªè»¸Î¼ã€ç¸¦è»¸logÏƒã®ç­‰é«˜ç·šã§ç¢ºç‡å¯†åº¦ã®åˆ†å¸ƒã‚’ç¢ºèªã™ã‚‹ã€‚ ç¸¦è»¸ã¯logÏƒãªã®ã§ã€äº‹å‰åˆ†å¸ƒã¯<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy=false >(</mo><mi>Î¼</mi><mo separator=true >,</mo><mi>log</mi><mo>â¡</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy=false >)</mo><mo>âˆ</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p(Î¼,\log{Ïƒ^2})âˆ1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal">Î¼</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mop >lo<span style="margin-right:0.01389em;">g</span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >âˆ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>ã¨ãªã‚‹ã€‚ è¨ˆç®—ã¯ã‚°ãƒªãƒƒãƒ‰è¿‘ä¼¼ã‚’ç”¨ã„ã¦è¡Œã†ã€‚</p> <pre><code class="julia hljs">log_likelihood_a(y,Î¼,Ïƒ)=sum(logpdf.(Normal(Î¼,Ïƒ),y))
<span class=hljs-keyword >function</span> likelihood_matrix_a(y,Î¼_range,logÏƒ_range)
    m = log_likelihood_a.(<span class=hljs-built_in >Ref</span>(y),Î¼_range&#x27;,exp.(logÏƒ_range))
    exp.(m .- maximum(m))
<span class=hljs-keyword >end</span>
Î¼_range=<span class=hljs-number >0</span>:<span class=hljs-number >5</span>//<span class=hljs-number >100</span>:<span class=hljs-number >20</span>
logÏƒ_range=-<span class=hljs-number >2</span>:<span class=hljs-number >5</span>//<span class=hljs-number >100</span>:<span class=hljs-number >3</span>
contour_levels=[<span class=hljs-number >.0001</span>; <span class=hljs-number >.001</span>; <span class=hljs-number >.01</span>; <span class=hljs-number >.05</span>:<span class=hljs-number >.05</span>:<span class=hljs-number >.95</span>;]
matrix_a=likelihood_matrix_a(y,Î¼_range,logÏƒ_range)
contour(Î¼_range, logÏƒ_range, matrix_a, levels=contour_levels, title=<span class=hljs-string >&quot;Probability Distribution (a)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;contour_a.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <pre><code class="julia hljs"><span class=hljs-keyword >function</span> log_likelihood_b(y,Î¼,Ïƒ)
    normaldist=Normal(Î¼,Ïƒ)
    sum(log.(cdf(normaldist, y .+ <span class=hljs-number >0.5</span>) .- cdf(normaldist, y .- <span class=hljs-number >0.5</span>)))
<span class=hljs-keyword >end</span>
<span class=hljs-keyword >function</span> likelihood_matrix_b(y,Î¼_range,logÏƒ_range)
    m = log_likelihood_b.(<span class=hljs-built_in >Ref</span>(y),Î¼_range&#x27;,exp.(logÏƒ_range))
    exp.(m .- maximum(m))
<span class=hljs-keyword >end</span>
matrix_b=likelihood_matrix_b(y,Î¼_range,logÏƒ_range)
contour(Î¼_range, logÏƒ_range, matrix_b, levels=contour_levels, title=<span class=hljs-string >&quot;Probability Distribution (b)&quot;</span>)
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;contour_b.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre> <p><img src="/assets/pages/BDA3_Exercises3_10_5/code/output/contour_a.svg" alt=""> <img src="/assets/pages/BDA3_Exercises3_10_5/code/output/contour_b.svg" alt=""></p> <p>ã“ã®å›³ã¯æ¨ªè»¸Î¼ã€ç¸¦è»¸logÏƒã®ç¢ºç‡å¯†åº¦ã®ç­‰é«˜ç·šã§ã‚ã‚‹ã€‚ &#40;a&#41;ã¨&#40;b&#41;ã‚’æ¯”è¼ƒã™ã‚‹ã¨ã€&#40;b&#41;ã®æ–¹ãŒåˆ†æ•£ãŒå°ã•ã„æ–¹å‘ã«ç¢ºç‡å¯†åº¦ãŒå‚¾ã„ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚</p> <p>çµ±è¨ˆé‡ã‚‚ç¢ºèªã™ã‚‹ã€‚</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> StatsBase
Î¼_weight_a = sum(matrix_a,dims=<span class=hljs-number >1</span>)|&gt;vec
Î¼_quantile_a=wquantile(Î¼_range,Î¼_weight_a,[<span class=hljs-number >.025</span>,<span class=hljs-number >.975</span>])
Ïƒ_weight_a = sum(matrix_a,dims=<span class=hljs-number >2</span>)|&gt;vec
Ïƒ_quantile_a=wquantile(exp.(logÏƒ_range),Ïƒ_weight_a,[<span class=hljs-number >.025</span>,<span class=hljs-number >.975</span>])

Î¼_weight_b = sum(matrix_b,dims=<span class=hljs-number >1</span>)|&gt;vec
Î¼_quantile_b=wquantile(Î¼_range,Î¼_weight_b,[<span class=hljs-number >.025</span>,<span class=hljs-number >.975</span>])
Ïƒ_weight_b = sum(matrix_b,dims=<span class=hljs-number >2</span>)|&gt;vec
Ïƒ_quantile_b=wquantile(exp.(logÏƒ_range),Ïƒ_weight_b,[<span class=hljs-number >.025</span>,<span class=hljs-number >.975</span>])

csv=<span class=hljs-string >&quot;&quot;&quot;åˆ†ä½æ•°,0.025,0.975
(a) Î¼,<span class=hljs-subst >$(join(round.(Î¼_quantile_a;digits=<span class=hljs-number >2</span>)</span>,&quot;,&quot;))
(b) Î¼,<span class=hljs-subst >$(join(round.(Î¼_quantile_b;digits=<span class=hljs-number >2</span>)</span>,&quot;,&quot;))
(a) Ïƒ,<span class=hljs-subst >$(join(round.(Ïƒ_quantile_a;digits=<span class=hljs-number >2</span>)</span>,&quot;,&quot;))
(b) Ïƒ,<span class=hljs-subst >$(join(round.(Ïƒ_quantile_b;digits=<span class=hljs-number >2</span>)</span>,&quot;,&quot;))&quot;&quot;&quot;</span>
write(joinpath(<span class=hljs-meta >@OUTPUT</span>,<span class=hljs-string >&quot;quantile.csv&quot;</span>), csv)
<span class=hljs-literal >nothing</span></code></pre><pre><code class="plaintext hljs">ArgumentError: Package StatsBase not found in current path.
- Run `import Pkg; Pkg.add(&quot;StatsBase&quot;)` to install the StatsBase package.
</code></pre> <p><span style="color:red;">// Table matching '/assets/pages/BDA3_Exercises3_10_5/code/output/quantile.csv' not found. //</span></p> <p>å¹³å‡ã¯å››æ¨äº”å…¥ã‚’è€ƒæ…®ã—ãŸå ´åˆã¨ã—ãªã„å ´åˆã§å¤§ããªå¤‰åŒ–ã¯ãªã„ãŒã€ æ¨™æº–åå·®ã¯å››æ¨äº”å…¥ã‚’è€ƒæ…®ã—ãŸå ´åˆã®æ–¹ãŒå°ã•ããªã£ã¦ã„ã‚‹ã€‚</p> <h2 id="d_å››æ¨äº”å…¥ã•ã‚Œã¦ã„ãªã„å®Ÿéš›ã®å€¤"><a href="#d_å››æ¨äº”å…¥ã•ã‚Œã¦ã„ãªã„å®Ÿéš›ã®å€¤" class=header-anchor >&#40;d&#41; å››æ¨äº”å…¥ã•ã‚Œã¦ã„ãªã„å®Ÿéš›ã®å€¤</a></h2> <p>å››æ¨äº”å…¥ã•ã‚Œã¦ã„ãªã„å®Ÿéš›ã®å€¤ã‚’zã¨ã™ã‚‹ã€‚ 5ã¤ã®è¦³æ¸¬å€¤yã«å¯¾ã—ã¦ã€ãã‚Œãã‚ŒzãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ã€‚ Î¼ã¨Ïƒã«é–¢ã—ã¦ã‚°ãƒªãƒƒãƒ‰è¿‘ä¼¼ã—ã¦ã„ã‚‹ã®ã§ã€ãã®ã‚°ãƒªãƒƒãƒ‰ã‚’ã‚¿ãƒ—ãƒ«&#40;Î¼, Ïƒ&#41;ã®ãƒãƒˆãƒªãƒƒã‚¯ã‚¹ã§ä½œæˆã™ã‚‹ã€‚</p> <pre><code class="julia hljs">Î¼Ïƒ_matrix = tuple.(Î¼_range, exp.(logÏƒ_range)&#x27;)
Î¼Ïƒ_matrix[<span class=hljs-number >1</span>:<span class=hljs-number >3</span>,<span class=hljs-number >1</span>:<span class=hljs-number >3</span>]</code></pre><pre><code class="plaintext hljs">3Ã—3 Matrix{Tuple{Rational{Int64}, Float64}}:
 (0//1, 0.135335)   (0//1, 0.142274)   (0//1, 0.149569)
 (1//20, 0.135335)  (1//20, 0.142274)  (1//20, 0.149569)
 (1//10, 0.135335)  (1//10, 0.142274)  (1//10, 0.149569)</code></pre> <pre><code class="julia hljs">Î¼Ïƒ_sample = wsample(Î¼Ïƒ_matrix, matrix_b&#x27;|&gt;vec)</code></pre><pre><code class="plaintext hljs">(207//20, 1.568312185490169)</code></pre>
<p>matrix<em>b&#39;ã¯Î¼Ïƒ</em>matrixã«å¯¾å¿œã™ã‚‹ç¢ºç‡å¯†åº¦ã§ã‚ã‚‹ã€‚ ã“ã‚Œã‚’é‡ã¿ä»˜ãã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã§ã€ç¢ºç‡å¯†åº¦ã‚’è€ƒæ…®ã—ã¦Î¼ã¨Ïƒã®çµ„ã¿åˆã‚ã›ã‚’é¸ã¶ã“ã¨ãŒã§ãã‚‹ã€‚ ã“ã‚Œã‚’å…ƒã«æ­£è¦åˆ†å¸ƒã‚’ä½œæˆã™ã‚‹ã€‚</p>
<pre><code class="julia hljs">Normal(Î¼Ïƒ_sample...)</code></pre><pre><code class="plaintext hljs">Distributions.Normal{Float64}(Î¼=10.35, Ïƒ=1.568312185490169)</code></pre>
<p>zä½œæˆé–¢æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚</p>
<pre><code class="julia hljs"><span class=hljs-keyword >function</span> z(normal_dists, yi)
    n=length(normal_dists)
    lowers = cdf.(normal_dists, yi-<span class=hljs-number >0.5</span>)
    uppers = cdf.(normal_dists, yi+<span class=hljs-number >0.5</span>)
    quantile.(normal_dists, lowers .+ rand(n) .* (uppers .- lowers))
<span class=hljs-keyword >end</span>
z([Normal(Î¼Ïƒ_sample...)], <span class=hljs-number >10</span>)</code></pre><pre><code class="plaintext hljs">1-element Vector{Float64}:
 10.008597872669055</code></pre>
<p>10ã®è¦³æ¸¬å€¤ã«å¯¾ã—ã¦ã€å››æ¨äº”å…¥ã™ã‚‹å‰ã®å€¤ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ã‚‹ã€‚ Î¼Ïƒ_matrixã‹ã‚‰5000ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦ã€5ã¤ã®è¦³æ¸¬å€¤yã«å¯¾å¿œã™ã‚‹zã‚’ãã‚Œãã‚Œ5000å€‹å‡ºåŠ›ã™ã‚‹ã€‚</p>
<pre><code class="julia hljs">Î¼Ïƒ_samples = wsample(Î¼Ïƒ_matrix,matrix_b&#x27;|&gt;vec,<span class=hljs-number >5000</span>)
normal_dists = [Normal(s...) <span class=hljs-keyword >for</span> s <span class=hljs-keyword >in</span> Î¼Ïƒ_samples]
zs = z.(normal_dists|&gt;<span class=hljs-built_in >Ref</span>, y)
histogram(zs[<span class=hljs-number >1</span>])
savefig(joinpath(<span class=hljs-meta >@OUTPUT</span>, <span class=hljs-string >&quot;histogram.svg&quot;</span>))
<span class=hljs-literal >nothing</span></code></pre>
<img src="/assets/pages/BDA3_Exercises3_10_5/code/output/histogram.svg" alt="">
<p>æ­£è¦åˆ†å¸ƒã®Î¼ãŒ10.4ä»˜è¿‘ã«ã‚ã‚‹ã¨è€ƒãˆã¦ã„ã‚‹ã®ã§ã€ä¸€æ§˜åˆ†å¸ƒã«ã¯ãªã£ã¦ã„ãªã„ã€‚ <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi>z</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>z</mi><mn>2</mn></msub><msup><mo stretchy=false >)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">(z_1-z_2)^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >âˆ’</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >â€‹</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>ã®å¹³å‡ã‚’è¨ˆç®—ã™ã‚‹ã¨</p>
<pre><code class="julia hljs">mean(abs2, (zs[<span class=hljs-number >1</span>] .- zs[<span class=hljs-number >2</span>]))</code></pre><pre><code class="plaintext hljs">0.16156252853964015</code></pre>
<p>ã¨ãªã‚‹ã€‚</p>
<div class=page-foot >
  <div class=copyright >
    &copy; dokudo91. Last modified: November 14, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>